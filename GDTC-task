{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "79864f28-9b0a-4471-be02-3ef8234234b2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b1b70658-29de-43b0-9cbe-dc1613836986",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "8340b4fd-1e4d-453c-91f5-783071eaec56",
   "metadata": {},
   "outputs": [],
   "source": [
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "5fe9b055-c748-4a2c-900c-ce5d5c3b8f6f",
   "metadata": {},
   "outputs": [],
   "source": [
    "from matplotlib import pyplot as plt\n",
    "from matplotlib.pyplot import pie,axis,show"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f80ff3f0-a1f1-4910-b525-ff352235be31",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "c58ddf86-22b6-4834-abb9-bd312e014471",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/Users/vikram/Documents/python project\n"
     ]
    }
   ],
   "source": [
    "working_directory=os.getcwd()\n",
    "print(working_directory)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "02787fd7-8e33-480a-a4fc-e13efde2c225",
   "metadata": {},
   "outputs": [],
   "source": [
    "path=working_directory+'/insurance_data.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "b6b68905-6fd7-42be-9433-30e03ed22ccb",
   "metadata": {},
   "outputs": [],
   "source": [
    "ins = pd.read_csv(path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "46f6de3e-54b7-44b5-b2fa-4f0aaccf3e4c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>CLAIM_STATUS</th>\n",
       "      <th>INCIDENT_SEVERITY</th>\n",
       "      <th>AUTHORITY_CONTACTED</th>\n",
       "      <th>ANY_INJURY</th>\n",
       "      <th>POLICE_REPORT_AVAILABLE</th>\n",
       "      <th>INCIDENT_STATE</th>\n",
       "      <th>INCIDENT_CITY</th>\n",
       "      <th>INCIDENT_HOUR_OF_THE_DAY</th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>VENDOR_ID</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Major Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>GA</td>\n",
       "      <td>Savannah</td>\n",
       "      <td>4</td>\n",
       "      <td>AGENT00413</td>\n",
       "      <td>VNDR00556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000002</td>\n",
       "      <td>A00008149</td>\n",
       "      <td>PLC00009594</td>\n",
       "      <td>2018-04-21</td>\n",
       "      <td>2020-05-13</td>\n",
       "      <td>2020-05-18</td>\n",
       "      <td>Property</td>\n",
       "      <td>141.71</td>\n",
       "      <td>26000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Total Loss</td>\n",
       "      <td>Ambulance</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>Montgomery</td>\n",
       "      <td>0</td>\n",
       "      <td>AGENT00769</td>\n",
       "      <td>VNDR00592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000003</td>\n",
       "      <td>A00003172</td>\n",
       "      <td>PLC00007969</td>\n",
       "      <td>2019-10-03</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>2020-05-26</td>\n",
       "      <td>Property</td>\n",
       "      <td>157.24</td>\n",
       "      <td>13000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Total Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>CO</td>\n",
       "      <td>Grand Junction</td>\n",
       "      <td>19</td>\n",
       "      <td>AGENT00883</td>\n",
       "      <td>VNDR00031</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000004</td>\n",
       "      <td>A00007572</td>\n",
       "      <td>PLC00009292</td>\n",
       "      <td>2016-11-29</td>\n",
       "      <td>2020-05-14</td>\n",
       "      <td>2020-05-19</td>\n",
       "      <td>Health</td>\n",
       "      <td>172.87</td>\n",
       "      <td>16000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Minor Loss</td>\n",
       "      <td>Ambulance</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>GA</td>\n",
       "      <td>Savannah</td>\n",
       "      <td>12</td>\n",
       "      <td>AGENT00278</td>\n",
       "      <td>VNDR00075</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000005</td>\n",
       "      <td>A00008173</td>\n",
       "      <td>PLC00000204</td>\n",
       "      <td>2011-12-26</td>\n",
       "      <td>2020-05-17</td>\n",
       "      <td>2020-05-22</td>\n",
       "      <td>Travel</td>\n",
       "      <td>88.53</td>\n",
       "      <td>3000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Major Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>TN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>18</td>\n",
       "      <td>AGENT00636</td>\n",
       "      <td>VNDR00472</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER POLICY_EFF_DT  \\\n",
       "0  2020-06-01 00:00:00    TXN00000001   A00003822   PLC00008468    2015-06-23   \n",
       "1  2020-06-01 00:00:00    TXN00000002   A00008149   PLC00009594    2018-04-21   \n",
       "2  2020-06-01 00:00:00    TXN00000003   A00003172   PLC00007969    2019-10-03   \n",
       "3  2020-06-01 00:00:00    TXN00000004   A00007572   PLC00009292    2016-11-29   \n",
       "4  2020-06-01 00:00:00    TXN00000005   A00008173   PLC00000204    2011-12-26   \n",
       "\n",
       "      LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  CLAIM_AMOUNT  ...  \\\n",
       "0  2020-05-16  2020-05-21         Health          157.13          9000  ...   \n",
       "1  2020-05-13  2020-05-18       Property          141.71         26000  ...   \n",
       "2  2020-05-21  2020-05-26       Property          157.24         13000  ...   \n",
       "3  2020-05-14  2020-05-19         Health          172.87         16000  ...   \n",
       "4  2020-05-17  2020-05-22         Travel           88.53          3000  ...   \n",
       "\n",
       "  CLAIM_STATUS INCIDENT_SEVERITY AUTHORITY_CONTACTED ANY_INJURY  \\\n",
       "0            A        Major Loss              Police          0   \n",
       "1            A        Total Loss           Ambulance          1   \n",
       "2            A        Total Loss              Police          0   \n",
       "3            A        Minor Loss           Ambulance          0   \n",
       "4            A        Major Loss              Police          0   \n",
       "\n",
       "  POLICE_REPORT_AVAILABLE  INCIDENT_STATE   INCIDENT_CITY  \\\n",
       "0                       1              GA        Savannah   \n",
       "1                       0              AL      Montgomery   \n",
       "2                       1              CO  Grand Junction   \n",
       "3                       0              GA        Savannah   \n",
       "4                       1              TN       Nashville   \n",
       "\n",
       "  INCIDENT_HOUR_OF_THE_DAY    AGENT_ID  VENDOR_ID  \n",
       "0                        4  AGENT00413  VNDR00556  \n",
       "1                        0  AGENT00769  VNDR00592  \n",
       "2                       19  AGENT00883  VNDR00031  \n",
       "3                       12  AGENT00278  VNDR00075  \n",
       "4                       18  AGENT00636  VNDR00472  \n",
       "\n",
       "[5 rows x 38 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ins.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "5029b50f-f1cf-4a1a-be3b-e8f1e366f97e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/Users/vikram/Documents/python project\n"
     ]
    }
   ],
   "source": [
    "working_directory=os.getcwd()\n",
    "print(working_directory)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "c4fa4b4d-2092-4265-886a-4ef59ff91d36",
   "metadata": {},
   "outputs": [],
   "source": [
    "path=working_directory+'/employee_data.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a40c72f2-5f8d-4d5a-88eb-08e168f4677f",
   "metadata": {},
   "outputs": [],
   "source": [
    "emp = pd.read_csv(path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "8d4814e8-62d2-45a9-af54-8a74697ff154",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>AGENT_NAME</th>\n",
       "      <th>DATE_OF_JOINING</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>EMP_ROUTING_NUMBER</th>\n",
       "      <th>EMP_ACCT_NUMBER</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>AGENT00001</td>\n",
       "      <td>Ray Johns</td>\n",
       "      <td>1993-06-05</td>\n",
       "      <td>1402 Maggies Way</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Waterbury Center</td>\n",
       "      <td>VT</td>\n",
       "      <td>5677</td>\n",
       "      <td>34584958</td>\n",
       "      <td>HKUN51252328472585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>AGENT00002</td>\n",
       "      <td>Angelo Borjon</td>\n",
       "      <td>2005-12-27</td>\n",
       "      <td>414 Tanya Pass</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32404</td>\n",
       "      <td>107363763</td>\n",
       "      <td>OPIS19290040088204</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>AGENT00003</td>\n",
       "      <td>Candy Spellman</td>\n",
       "      <td>2003-09-02</td>\n",
       "      <td>606 National Street</td>\n",
       "      <td>#306</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701</td>\n",
       "      <td>81744097</td>\n",
       "      <td>YSCJ67489688482590</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>AGENT00004</td>\n",
       "      <td>Mary Smith</td>\n",
       "      <td>2004-09-23</td>\n",
       "      <td>235 Hugh Thomas Drive</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32404</td>\n",
       "      <td>67563771</td>\n",
       "      <td>ZANG21285355574581</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>AGENT00005</td>\n",
       "      <td>Mildred Diaz</td>\n",
       "      <td>2011-06-21</td>\n",
       "      <td>3426 Broadview Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Montgomery</td>\n",
       "      <td>AL</td>\n",
       "      <td>36110</td>\n",
       "      <td>114951317</td>\n",
       "      <td>DZFS82244494451134</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     AGENT_ID      AGENT_NAME DATE_OF_JOINING          ADDRESS_LINE1  \\\n",
       "0  AGENT00001       Ray Johns      1993-06-05       1402 Maggies Way   \n",
       "1  AGENT00002   Angelo Borjon      2005-12-27         414 Tanya Pass   \n",
       "2  AGENT00003  Candy Spellman      2003-09-02    606 National Street   \n",
       "3  AGENT00004      Mary Smith      2004-09-23  235 Hugh Thomas Drive   \n",
       "4  AGENT00005    Mildred Diaz      2011-06-21  3426 Broadview Street   \n",
       "\n",
       "  ADDRESS_LINE2              CITY STATE  POSTAL_CODE  EMP_ROUTING_NUMBER  \\\n",
       "0           NaN  Waterbury Center    VT         5677            34584958   \n",
       "1           NaN       Panama City    FL        32404           107363763   \n",
       "2          #306      Fayetteville    AR        72701            81744097   \n",
       "3           NaN       Panama City    FL        32404            67563771   \n",
       "4           NaN        Montgomery    AL        36110           114951317   \n",
       "\n",
       "      EMP_ACCT_NUMBER  \n",
       "0  HKUN51252328472585  \n",
       "1  OPIS19290040088204  \n",
       "2  YSCJ67489688482590  \n",
       "3  ZANG21285355574581  \n",
       "4  DZFS82244494451134  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "emp.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "02f1da95-dae9-45b1-a004-a927e8fcda62",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/Users/vikram/Documents/python project\n"
     ]
    }
   ],
   "source": [
    "working_directory=os.getcwd()\n",
    "print(working_directory)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "5af12baa-d32b-40bc-bd65-f196028e61ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "path=working_directory+'/vendor_data.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "7e463c85-f20d-4026-af27-c3f3bfccd6d9",
   "metadata": {},
   "outputs": [],
   "source": [
    "ven = pd.read_csv(path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "da83e590-57e2-4ea7-8226-0dd3192a06fb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>VENDOR_ID</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>VNDR00001</td>\n",
       "      <td>King, Proctor and Jones</td>\n",
       "      <td>2027 North Shannon Drive</td>\n",
       "      <td>#5</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72703</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>VNDR00002</td>\n",
       "      <td>Garcia Ltd</td>\n",
       "      <td>5701 East Shirley Lane</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Montgomery</td>\n",
       "      <td>AL</td>\n",
       "      <td>36117</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>VNDR00003</td>\n",
       "      <td>Cherry LLC</td>\n",
       "      <td>1217 Cottondale Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Montgomery</td>\n",
       "      <td>AL</td>\n",
       "      <td>36109</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>VNDR00004</td>\n",
       "      <td>Mays-Benson</td>\n",
       "      <td>227 West Montgomery Cross Road</td>\n",
       "      <td>#736</td>\n",
       "      <td>Savannah</td>\n",
       "      <td>GA</td>\n",
       "      <td>31406</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>VNDR00005</td>\n",
       "      <td>Wilson PLC</td>\n",
       "      <td>23 North Hill Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37210</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   VENDOR_ID              VENDOR_NAME                   ADDRESS_LINE1  \\\n",
       "0  VNDR00001  King, Proctor and Jones        2027 North Shannon Drive   \n",
       "1  VNDR00002               Garcia Ltd          5701 East Shirley Lane   \n",
       "2  VNDR00003               Cherry LLC            1217 Cottondale Road   \n",
       "3  VNDR00004              Mays-Benson  227 West Montgomery Cross Road   \n",
       "4  VNDR00005               Wilson PLC            23 North Hill Street   \n",
       "\n",
       "  ADDRESS_LINE2          CITY STATE  POSTAL_CODE  \n",
       "0            #5  Fayetteville    AR        72703  \n",
       "1           NaN    Montgomery    AL        36117  \n",
       "2           NaN    Montgomery    AL        36109  \n",
       "3          #736      Savannah    GA        31406  \n",
       "4           NaN     Nashville    TN        37210  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ven.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4b98e185-bd7b-47a5-9f34-1357e110e11b",
   "metadata": {},
   "outputs": [],
   "source": [
    "##1-Merging all Three Dataset And Creating 1 view"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "7eb29eaa-75eb-4f18-9a5f-fec53bb60968",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>VENDOR_ID</th>\n",
       "      <th>AGENT_NAME</th>\n",
       "      <th>DATE_OF_JOINING</th>\n",
       "      <th>ADDRESS_LINE1_y</th>\n",
       "      <th>ADDRESS_LINE2_y</th>\n",
       "      <th>CITY_y</th>\n",
       "      <th>STATE_y</th>\n",
       "      <th>POSTAL_CODE_y</th>\n",
       "      <th>EMP_ROUTING_NUMBER</th>\n",
       "      <th>EMP_ACCT_NUMBER</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000</td>\n",
       "      <td>...</td>\n",
       "      <td>VNDR00556</td>\n",
       "      <td>Amy Wangler</td>\n",
       "      <td>1994-01-06</td>\n",
       "      <td>584 Rural Hill Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217</td>\n",
       "      <td>35441155</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-06-10 00:00:00</td>\n",
       "      <td>TXN00000258</td>\n",
       "      <td>A00003072</td>\n",
       "      <td>PLC00008557</td>\n",
       "      <td>2014-02-15</td>\n",
       "      <td>2020-05-27</td>\n",
       "      <td>2020-06-01</td>\n",
       "      <td>Life</td>\n",
       "      <td>57.15</td>\n",
       "      <td>54000</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Amy Wangler</td>\n",
       "      <td>1994-01-06</td>\n",
       "      <td>584 Rural Hill Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217</td>\n",
       "      <td>35441155</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-09-07 00:00:00</td>\n",
       "      <td>TXN00002428</td>\n",
       "      <td>A00001447</td>\n",
       "      <td>PLC00004391</td>\n",
       "      <td>2015-01-30</td>\n",
       "      <td>2020-08-23</td>\n",
       "      <td>2020-08-28</td>\n",
       "      <td>Life</td>\n",
       "      <td>65.06</td>\n",
       "      <td>13000</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Amy Wangler</td>\n",
       "      <td>1994-01-06</td>\n",
       "      <td>584 Rural Hill Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217</td>\n",
       "      <td>35441155</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-09-22 00:00:00</td>\n",
       "      <td>TXN00002811</td>\n",
       "      <td>A00001822</td>\n",
       "      <td>PLC00009369</td>\n",
       "      <td>2012-08-22</td>\n",
       "      <td>2020-09-06</td>\n",
       "      <td>2020-09-11</td>\n",
       "      <td>Life</td>\n",
       "      <td>87.16</td>\n",
       "      <td>42000</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Amy Wangler</td>\n",
       "      <td>1994-01-06</td>\n",
       "      <td>584 Rural Hill Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217</td>\n",
       "      <td>35441155</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-09-24 00:00:00</td>\n",
       "      <td>TXN00002861</td>\n",
       "      <td>A00006019</td>\n",
       "      <td>PLC00006747</td>\n",
       "      <td>2017-02-05</td>\n",
       "      <td>2020-09-14</td>\n",
       "      <td>2020-09-17</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>11.85</td>\n",
       "      <td>500</td>\n",
       "      <td>...</td>\n",
       "      <td>VNDR00344</td>\n",
       "      <td>Amy Wangler</td>\n",
       "      <td>1994-01-06</td>\n",
       "      <td>584 Rural Hill Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217</td>\n",
       "      <td>35441155</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9995</th>\n",
       "      <td>2021-04-28 00:00:00</td>\n",
       "      <td>TXN00008381</td>\n",
       "      <td>A00006144</td>\n",
       "      <td>PLC00005140</td>\n",
       "      <td>2012-10-23</td>\n",
       "      <td>2021-04-15</td>\n",
       "      <td>2021-04-20</td>\n",
       "      <td>Life</td>\n",
       "      <td>64.16</td>\n",
       "      <td>93000</td>\n",
       "      <td>...</td>\n",
       "      <td>VNDR00378</td>\n",
       "      <td>Angel Alexander</td>\n",
       "      <td>2012-08-26</td>\n",
       "      <td>44 Downey Drive</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>CT</td>\n",
       "      <td>6040</td>\n",
       "      <td>55484383</td>\n",
       "      <td>CLKD05622028357384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9996</th>\n",
       "      <td>2021-05-02 00:00:00</td>\n",
       "      <td>TXN00008462</td>\n",
       "      <td>A00004250</td>\n",
       "      <td>PLC00009507</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>2021-04-20</td>\n",
       "      <td>2021-04-25</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>9.76</td>\n",
       "      <td>300</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Angel Alexander</td>\n",
       "      <td>2012-08-26</td>\n",
       "      <td>44 Downey Drive</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>CT</td>\n",
       "      <td>6040</td>\n",
       "      <td>55484383</td>\n",
       "      <td>CLKD05622028357384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9997</th>\n",
       "      <td>2021-06-08 00:00:00</td>\n",
       "      <td>TXN00009410</td>\n",
       "      <td>A00004412</td>\n",
       "      <td>PLC00005536</td>\n",
       "      <td>2019-11-25</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>Motor</td>\n",
       "      <td>97.78</td>\n",
       "      <td>3000</td>\n",
       "      <td>...</td>\n",
       "      <td>VNDR00580</td>\n",
       "      <td>Angel Alexander</td>\n",
       "      <td>2012-08-26</td>\n",
       "      <td>44 Downey Drive</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>CT</td>\n",
       "      <td>6040</td>\n",
       "      <td>55484383</td>\n",
       "      <td>CLKD05622028357384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9998</th>\n",
       "      <td>2021-06-21 00:00:00</td>\n",
       "      <td>TXN00009756</td>\n",
       "      <td>A00003267</td>\n",
       "      <td>PLC00007273</td>\n",
       "      <td>2012-09-29</td>\n",
       "      <td>2021-06-01</td>\n",
       "      <td>2021-06-06</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>7.64</td>\n",
       "      <td>200</td>\n",
       "      <td>...</td>\n",
       "      <td>VNDR00383</td>\n",
       "      <td>Angel Alexander</td>\n",
       "      <td>2012-08-26</td>\n",
       "      <td>44 Downey Drive</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>CT</td>\n",
       "      <td>6040</td>\n",
       "      <td>55484383</td>\n",
       "      <td>CLKD05622028357384</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9999</th>\n",
       "      <td>2021-05-11 00:00:00</td>\n",
       "      <td>TXN00008671</td>\n",
       "      <td>A00006937</td>\n",
       "      <td>PLC00007149</td>\n",
       "      <td>2016-01-11</td>\n",
       "      <td>2021-05-08</td>\n",
       "      <td>2021-05-08</td>\n",
       "      <td>Life</td>\n",
       "      <td>73.51</td>\n",
       "      <td>49000</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Charlotte Payne</td>\n",
       "      <td>2012-10-12</td>\n",
       "      <td>200 Boulder Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Manchester</td>\n",
       "      <td>CT</td>\n",
       "      <td>6040</td>\n",
       "      <td>118343345</td>\n",
       "      <td>HEWS38892486083575</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10000 rows × 47 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER  \\\n",
       "0     2020-06-01 00:00:00    TXN00000001   A00003822   PLC00008468   \n",
       "1     2020-06-10 00:00:00    TXN00000258   A00003072   PLC00008557   \n",
       "2     2020-09-07 00:00:00    TXN00002428   A00001447   PLC00004391   \n",
       "3     2020-09-22 00:00:00    TXN00002811   A00001822   PLC00009369   \n",
       "4     2020-09-24 00:00:00    TXN00002861   A00006019   PLC00006747   \n",
       "...                   ...            ...         ...           ...   \n",
       "9995  2021-04-28 00:00:00    TXN00008381   A00006144   PLC00005140   \n",
       "9996  2021-05-02 00:00:00    TXN00008462   A00004250   PLC00009507   \n",
       "9997  2021-06-08 00:00:00    TXN00009410   A00004412   PLC00005536   \n",
       "9998  2021-06-21 00:00:00    TXN00009756   A00003267   PLC00007273   \n",
       "9999  2021-05-11 00:00:00    TXN00008671   A00006937   PLC00007149   \n",
       "\n",
       "     POLICY_EFF_DT     LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  \\\n",
       "0       2015-06-23  2020-05-16  2020-05-21         Health          157.13   \n",
       "1       2014-02-15  2020-05-27  2020-06-01           Life           57.15   \n",
       "2       2015-01-30  2020-08-23  2020-08-28           Life           65.06   \n",
       "3       2012-08-22  2020-09-06  2020-09-11           Life           87.16   \n",
       "4       2017-02-05  2020-09-14  2020-09-17         Mobile           11.85   \n",
       "...            ...         ...         ...            ...             ...   \n",
       "9995    2012-10-23  2021-04-15  2021-04-20           Life           64.16   \n",
       "9996    2019-08-30  2021-04-20  2021-04-25         Mobile            9.76   \n",
       "9997    2019-11-25  2021-06-05  2021-06-05          Motor           97.78   \n",
       "9998    2012-09-29  2021-06-01  2021-06-06         Mobile            7.64   \n",
       "9999    2016-01-11  2021-05-08  2021-05-08           Life           73.51   \n",
       "\n",
       "      CLAIM_AMOUNT  ...  VENDOR_ID       AGENT_NAME DATE_OF_JOINING  \\\n",
       "0             9000  ...  VNDR00556      Amy Wangler      1994-01-06   \n",
       "1            54000  ...        NaN      Amy Wangler      1994-01-06   \n",
       "2            13000  ...        NaN      Amy Wangler      1994-01-06   \n",
       "3            42000  ...        NaN      Amy Wangler      1994-01-06   \n",
       "4              500  ...  VNDR00344      Amy Wangler      1994-01-06   \n",
       "...            ...  ...        ...              ...             ...   \n",
       "9995         93000  ...  VNDR00378  Angel Alexander      2012-08-26   \n",
       "9996           300  ...        NaN  Angel Alexander      2012-08-26   \n",
       "9997          3000  ...  VNDR00580  Angel Alexander      2012-08-26   \n",
       "9998           200  ...  VNDR00383  Angel Alexander      2012-08-26   \n",
       "9999         49000  ...        NaN  Charlotte Payne      2012-10-12   \n",
       "\n",
       "          ADDRESS_LINE1_y ADDRESS_LINE2_y      CITY_y STATE_y POSTAL_CODE_y  \\\n",
       "0     584 Rural Hill Road             NaN   Nashville      TN         37217   \n",
       "1     584 Rural Hill Road             NaN   Nashville      TN         37217   \n",
       "2     584 Rural Hill Road             NaN   Nashville      TN         37217   \n",
       "3     584 Rural Hill Road             NaN   Nashville      TN         37217   \n",
       "4     584 Rural Hill Road             NaN   Nashville      TN         37217   \n",
       "...                   ...             ...         ...     ...           ...   \n",
       "9995      44 Downey Drive             NaN  Manchester      CT          6040   \n",
       "9996      44 Downey Drive             NaN  Manchester      CT          6040   \n",
       "9997      44 Downey Drive             NaN  Manchester      CT          6040   \n",
       "9998      44 Downey Drive             NaN  Manchester      CT          6040   \n",
       "9999     200 Boulder Road             NaN  Manchester      CT          6040   \n",
       "\n",
       "      EMP_ROUTING_NUMBER     EMP_ACCT_NUMBER  \n",
       "0               35441155  LRZO53254369804934  \n",
       "1               35441155  LRZO53254369804934  \n",
       "2               35441155  LRZO53254369804934  \n",
       "3               35441155  LRZO53254369804934  \n",
       "4               35441155  LRZO53254369804934  \n",
       "...                  ...                 ...  \n",
       "9995            55484383  CLKD05622028357384  \n",
       "9996            55484383  CLKD05622028357384  \n",
       "9997            55484383  CLKD05622028357384  \n",
       "9998            55484383  CLKD05622028357384  \n",
       "9999           118343345  HEWS38892486083575  \n",
       "\n",
       "[10000 rows x 47 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc1 = pd.merge(ins,emp,on=\"AGENT_ID\",how = \"outer\")\n",
    "doc1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "14b1f2a0-b9fa-42da-948c-365da14222de",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>STATE_y</th>\n",
       "      <th>POSTAL_CODE_y</th>\n",
       "      <th>EMP_ROUTING_NUMBER</th>\n",
       "      <th>EMP_ACCT_NUMBER</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>TN</td>\n",
       "      <td>37217.0</td>\n",
       "      <td>35441155.0</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-07-25 00:00:00</td>\n",
       "      <td>TXN00001387</td>\n",
       "      <td>A00005010</td>\n",
       "      <td>PLC00003215</td>\n",
       "      <td>2013-06-09</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>2020-07-18</td>\n",
       "      <td>Motor</td>\n",
       "      <td>102.83</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>KY</td>\n",
       "      <td>40291.0</td>\n",
       "      <td>106847442.0</td>\n",
       "      <td>IYLB01551123255113</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-06-08 00:00:00</td>\n",
       "      <td>TXN00009413</td>\n",
       "      <td>A00004104</td>\n",
       "      <td>PLC00006793</td>\n",
       "      <td>2013-02-09</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>Health</td>\n",
       "      <td>141.61</td>\n",
       "      <td>4000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>AK</td>\n",
       "      <td>99503.0</td>\n",
       "      <td>50013115.0</td>\n",
       "      <td>VWII94517745930110</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-11-16 00:00:00</td>\n",
       "      <td>TXN00004165</td>\n",
       "      <td>A00005167</td>\n",
       "      <td>PLC00007395</td>\n",
       "      <td>2017-11-29</td>\n",
       "      <td>2020-11-08</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>Travel</td>\n",
       "      <td>67.68</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>MA</td>\n",
       "      <td>2721.0</td>\n",
       "      <td>10623451.0</td>\n",
       "      <td>CPIE92788049884734</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-06-15 00:00:00</td>\n",
       "      <td>TXN00000392</td>\n",
       "      <td>A00004444</td>\n",
       "      <td>PLC00006287</td>\n",
       "      <td>2011-09-24</td>\n",
       "      <td>2020-05-29</td>\n",
       "      <td>2020-06-03</td>\n",
       "      <td>Life</td>\n",
       "      <td>78.38</td>\n",
       "      <td>56000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>OK</td>\n",
       "      <td>73114.0</td>\n",
       "      <td>111257001.0</td>\n",
       "      <td>LQRX58976259076318</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10188</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Barnes, Moore and Morris</td>\n",
       "      <td>2375 South School Avenue</td>\n",
       "      <td>#5</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10189</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Smith, Simmons and Perez</td>\n",
       "      <td>314 South 17th Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37206.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10190</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Cooper, Jones and Maldonado</td>\n",
       "      <td>735 West Treadwell Street</td>\n",
       "      <td>#33</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10191</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hutchinson, Matthews and Wilcox</td>\n",
       "      <td>1318 4th Street Southwest</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Washington</td>\n",
       "      <td>DC</td>\n",
       "      <td>20024.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10192</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Rhodes-Mendez</td>\n",
       "      <td>1689 Fisher Pond Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Saint Albans City</td>\n",
       "      <td>VT</td>\n",
       "      <td>5478.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10193 rows × 53 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER  \\\n",
       "0      2020-06-01 00:00:00    TXN00000001   A00003822   PLC00008468   \n",
       "1      2020-07-25 00:00:00    TXN00001387   A00005010   PLC00003215   \n",
       "2      2021-06-08 00:00:00    TXN00009413   A00004104   PLC00006793   \n",
       "3      2020-11-16 00:00:00    TXN00004165   A00005167   PLC00007395   \n",
       "4      2020-06-15 00:00:00    TXN00000392   A00004444   PLC00006287   \n",
       "...                    ...            ...         ...           ...   \n",
       "10188                  NaN            NaN         NaN           NaN   \n",
       "10189                  NaN            NaN         NaN           NaN   \n",
       "10190                  NaN            NaN         NaN           NaN   \n",
       "10191                  NaN            NaN         NaN           NaN   \n",
       "10192                  NaN            NaN         NaN           NaN   \n",
       "\n",
       "      POLICY_EFF_DT     LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  \\\n",
       "0        2015-06-23  2020-05-16  2020-05-21         Health          157.13   \n",
       "1        2013-06-09  2020-07-13  2020-07-18          Motor          102.83   \n",
       "2        2013-02-09  2021-06-05  2021-06-05         Health          141.61   \n",
       "3        2017-11-29  2020-11-08  2020-11-11         Travel           67.68   \n",
       "4        2011-09-24  2020-05-29  2020-06-03           Life           78.38   \n",
       "...             ...         ...         ...            ...             ...   \n",
       "10188           NaN         NaN         NaN            NaN             NaN   \n",
       "10189           NaN         NaN         NaN            NaN             NaN   \n",
       "10190           NaN         NaN         NaN            NaN             NaN   \n",
       "10191           NaN         NaN         NaN            NaN             NaN   \n",
       "10192           NaN         NaN         NaN            NaN             NaN   \n",
       "\n",
       "       CLAIM_AMOUNT  ... STATE_y POSTAL_CODE_y EMP_ROUTING_NUMBER  \\\n",
       "0            9000.0  ...      TN       37217.0         35441155.0   \n",
       "1           10000.0  ...      KY       40291.0        106847442.0   \n",
       "2            4000.0  ...      AK       99503.0         50013115.0   \n",
       "3            3000.0  ...      MA        2721.0         10623451.0   \n",
       "4           56000.0  ...      OK       73114.0        111257001.0   \n",
       "...             ...  ...     ...           ...                ...   \n",
       "10188           NaN  ...     NaN           NaN                NaN   \n",
       "10189           NaN  ...     NaN           NaN                NaN   \n",
       "10190           NaN  ...     NaN           NaN                NaN   \n",
       "10191           NaN  ...     NaN           NaN                NaN   \n",
       "10192           NaN  ...     NaN           NaN                NaN   \n",
       "\n",
       "          EMP_ACCT_NUMBER                      VENDOR_NAME  \\\n",
       "0      LRZO53254369804934                       Ramsey Inc   \n",
       "1      IYLB01551123255113                       Ramsey Inc   \n",
       "2      VWII94517745930110                       Ramsey Inc   \n",
       "3      CPIE92788049884734                       Ramsey Inc   \n",
       "4      LQRX58976259076318                       Ramsey Inc   \n",
       "...                   ...                              ...   \n",
       "10188                 NaN         Barnes, Moore and Morris   \n",
       "10189                 NaN         Smith, Simmons and Perez   \n",
       "10190                 NaN      Cooper, Jones and Maldonado   \n",
       "10191                 NaN  Hutchinson, Matthews and Wilcox   \n",
       "10192                 NaN                    Rhodes-Mendez   \n",
       "\n",
       "                   ADDRESS_LINE1 ADDRESS_LINE2               CITY  STATE  \\\n",
       "0           3114 West 20th Court           NaN        Panama City     FL   \n",
       "1           3114 West 20th Court           NaN        Panama City     FL   \n",
       "2           3114 West 20th Court           NaN        Panama City     FL   \n",
       "3           3114 West 20th Court           NaN        Panama City     FL   \n",
       "4           3114 West 20th Court           NaN        Panama City     FL   \n",
       "...                          ...           ...                ...    ...   \n",
       "10188   2375 South School Avenue            #5       Fayetteville     AR   \n",
       "10189      314 South 17th Street           NaN          Nashville     TN   \n",
       "10190  735 West Treadwell Street           #33       Fayetteville     AR   \n",
       "10191  1318 4th Street Southwest           NaN         Washington     DC   \n",
       "10192      1689 Fisher Pond Road           NaN  Saint Albans City     VT   \n",
       "\n",
       "       POSTAL_CODE  \n",
       "0          32405.0  \n",
       "1          32405.0  \n",
       "2          32405.0  \n",
       "3          32405.0  \n",
       "4          32405.0  \n",
       "...            ...  \n",
       "10188      72701.0  \n",
       "10189      37206.0  \n",
       "10190      72701.0  \n",
       "10191      20024.0  \n",
       "10192       5478.0  \n",
       "\n",
       "[10193 rows x 53 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## All 3 Dataset merged As doc2\n",
    "\n",
    "\n",
    "doc2 = pd.merge(doc1,ven,on= 'VENDOR_ID',how=\"outer\")\n",
    "doc2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "d0ae1349-9aff-4a04-a2c8-0c868422df8c",
   "metadata": {},
   "outputs": [],
   "source": [
    "## 2-: Top 3 Insurance Type where we are getting most insurance claims."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "55b980d9-f132-4f70-a85c-8798fa19a00e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>CLAIM_STATUS</th>\n",
       "      <th>INCIDENT_SEVERITY</th>\n",
       "      <th>AUTHORITY_CONTACTED</th>\n",
       "      <th>ANY_INJURY</th>\n",
       "      <th>POLICE_REPORT_AVAILABLE</th>\n",
       "      <th>INCIDENT_STATE</th>\n",
       "      <th>INCIDENT_CITY</th>\n",
       "      <th>INCIDENT_HOUR_OF_THE_DAY</th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>VENDOR_ID</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Major Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>GA</td>\n",
       "      <td>Savannah</td>\n",
       "      <td>4</td>\n",
       "      <td>AGENT00413</td>\n",
       "      <td>VNDR00556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000002</td>\n",
       "      <td>A00008149</td>\n",
       "      <td>PLC00009594</td>\n",
       "      <td>2018-04-21</td>\n",
       "      <td>2020-05-13</td>\n",
       "      <td>2020-05-18</td>\n",
       "      <td>Property</td>\n",
       "      <td>141.71</td>\n",
       "      <td>26000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Total Loss</td>\n",
       "      <td>Ambulance</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>AL</td>\n",
       "      <td>Montgomery</td>\n",
       "      <td>0</td>\n",
       "      <td>AGENT00769</td>\n",
       "      <td>VNDR00592</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000003</td>\n",
       "      <td>A00003172</td>\n",
       "      <td>PLC00007969</td>\n",
       "      <td>2019-10-03</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>2020-05-26</td>\n",
       "      <td>Property</td>\n",
       "      <td>157.24</td>\n",
       "      <td>13000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Total Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>CO</td>\n",
       "      <td>Grand Junction</td>\n",
       "      <td>19</td>\n",
       "      <td>AGENT00883</td>\n",
       "      <td>VNDR00031</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000004</td>\n",
       "      <td>A00007572</td>\n",
       "      <td>PLC00009292</td>\n",
       "      <td>2016-11-29</td>\n",
       "      <td>2020-05-14</td>\n",
       "      <td>2020-05-19</td>\n",
       "      <td>Health</td>\n",
       "      <td>172.87</td>\n",
       "      <td>16000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Minor Loss</td>\n",
       "      <td>Ambulance</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>GA</td>\n",
       "      <td>Savannah</td>\n",
       "      <td>12</td>\n",
       "      <td>AGENT00278</td>\n",
       "      <td>VNDR00075</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-06-01 00:00:00</td>\n",
       "      <td>TXN00000005</td>\n",
       "      <td>A00008173</td>\n",
       "      <td>PLC00000204</td>\n",
       "      <td>2011-12-26</td>\n",
       "      <td>2020-05-17</td>\n",
       "      <td>2020-05-22</td>\n",
       "      <td>Travel</td>\n",
       "      <td>88.53</td>\n",
       "      <td>3000</td>\n",
       "      <td>...</td>\n",
       "      <td>A</td>\n",
       "      <td>Major Loss</td>\n",
       "      <td>Police</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>TN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>18</td>\n",
       "      <td>AGENT00636</td>\n",
       "      <td>VNDR00472</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER POLICY_EFF_DT  \\\n",
       "0  2020-06-01 00:00:00    TXN00000001   A00003822   PLC00008468    2015-06-23   \n",
       "1  2020-06-01 00:00:00    TXN00000002   A00008149   PLC00009594    2018-04-21   \n",
       "2  2020-06-01 00:00:00    TXN00000003   A00003172   PLC00007969    2019-10-03   \n",
       "3  2020-06-01 00:00:00    TXN00000004   A00007572   PLC00009292    2016-11-29   \n",
       "4  2020-06-01 00:00:00    TXN00000005   A00008173   PLC00000204    2011-12-26   \n",
       "\n",
       "      LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  CLAIM_AMOUNT  ...  \\\n",
       "0  2020-05-16  2020-05-21         Health          157.13          9000  ...   \n",
       "1  2020-05-13  2020-05-18       Property          141.71         26000  ...   \n",
       "2  2020-05-21  2020-05-26       Property          157.24         13000  ...   \n",
       "3  2020-05-14  2020-05-19         Health          172.87         16000  ...   \n",
       "4  2020-05-17  2020-05-22         Travel           88.53          3000  ...   \n",
       "\n",
       "  CLAIM_STATUS INCIDENT_SEVERITY AUTHORITY_CONTACTED ANY_INJURY  \\\n",
       "0            A        Major Loss              Police          0   \n",
       "1            A        Total Loss           Ambulance          1   \n",
       "2            A        Total Loss              Police          0   \n",
       "3            A        Minor Loss           Ambulance          0   \n",
       "4            A        Major Loss              Police          0   \n",
       "\n",
       "  POLICE_REPORT_AVAILABLE  INCIDENT_STATE   INCIDENT_CITY  \\\n",
       "0                       1              GA        Savannah   \n",
       "1                       0              AL      Montgomery   \n",
       "2                       1              CO  Grand Junction   \n",
       "3                       0              GA        Savannah   \n",
       "4                       1              TN       Nashville   \n",
       "\n",
       "  INCIDENT_HOUR_OF_THE_DAY    AGENT_ID  VENDOR_ID  \n",
       "0                        4  AGENT00413  VNDR00556  \n",
       "1                        0  AGENT00769  VNDR00592  \n",
       "2                       19  AGENT00883  VNDR00031  \n",
       "3                       12  AGENT00278  VNDR00075  \n",
       "4                       18  AGENT00636  VNDR00472  \n",
       "\n",
       "[5 rows x 38 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ins.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "3156a70f-b654-4d9e-a9bf-cb81464432ed",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/vikram/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='INSURANCE_TYPE', ylabel='count'>"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.countplot(doc2.INSURANCE_TYPE)\t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "761b1350-c1f9-4cca-a6cb-2c83deaf7dd6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Property    1692\n",
       "Mobile      1692\n",
       "Health      1690\n",
       "Name: INSURANCE_TYPE, dtype: int64"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ins['INSURANCE_TYPE'].value_counts()[:3]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "32777dce-0414-4bdd-80da-7e47166a24e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "##Top-3 Insurance Type where we are getting most insurance claims - \n",
    " ##                       1-: Property\n",
    " ##                      2-: Mobile\n",
    " ##                      3-:Health "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "3d6b77c9-bd06-46a4-9898-4ae902e2f3ed",
   "metadata": {},
   "outputs": [],
   "source": [
    "## 3-: Top 5 States where we are getting most insurance claims"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "8ffd7051-561c-4fa1-81c4-4dd024ab1889",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/vikram/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='STATE', ylabel='count'>"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.countplot(ins.STATE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "c9b3dcd2-6d4e-46ad-8af2-c4be1d660ee9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "CA    1035\n",
       "CO     677\n",
       "FL     650\n",
       "AR     644\n",
       "TN     641\n",
       "AL     623\n",
       "GA     613\n",
       "AZ     603\n",
       "CT     594\n",
       "KY     581\n",
       "DC     581\n",
       "VT     579\n",
       "MD     576\n",
       "MA     549\n",
       "OK     531\n",
       "AK     523\n",
       "Name: STATE, dtype: int64"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ins.STATE.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "dab7df60-ff52-43ed-9809-65c105e2bc22",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "STATE  RISK_SEGMENTATION\n",
       "CA     H                    148\n",
       "AZ     H                    105\n",
       "FL     H                    104\n",
       "TN     H                    100\n",
       "AR     H                     97\n",
       "dtype: int64"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "h_risk_state=ins[['STATE','RISK_SEGMENTATION']] [ins['RISK_SEGMENTATION'] == 'H']\n",
    "h_risk_state.value_counts()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "d231fff2-55be-4e88-a573-64274fb4e67a",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/vikram/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='STATE', ylabel='count'>"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.countplot(h_risk_state.STATE)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "5f0664ea-6004-4d91-97b9-c0aeb03e5501",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Tp 5 state where we are getting most insurance claims for customer belonging to HIGH(H) risk segment are\n",
    "# 1-CA     \n",
    "# 2-AZ\n",
    "# 3-FL\n",
    "# 4-TN\n",
    "# 5-AR"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "2a89eb30-ddfd-477d-bd4b-fad62d3b0a63",
   "metadata": {},
   "outputs": [],
   "source": [
    "## 4-: “COLOCATION\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e8b896ec-7622-4bf4-a0e5-2b6c47842a9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def colocation(row):\n",
    "    if (row['STATE_y'] == row['INCIDENT_STATE']) & (row['STATE_y'] == row['STATE_x']):\n",
    "        val = 1\n",
    "    else:\n",
    "        val = 0\n",
    "    return val\n",
    "\n",
    "doc2['Colocation'] = doc2.apply(colocation, axis= 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "c464e98d-0cbb-4e3c-a16c-474fae83c716",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    10193.000000\n",
       "mean         0.004317\n",
       "std          0.065563\n",
       "min          0.000000\n",
       "25%          0.000000\n",
       "50%          0.000000\n",
       "75%          0.000000\n",
       "max          1.000000\n",
       "Name: Colocation, dtype: float64"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2.Colocation.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "4a375714-cb3c-426b-81a6-cde1adc8e3ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.00431668792308447"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2.Colocation.mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "d3c6347b-b89c-4756-872e-3ec7780f8fea",
   "metadata": {},
   "outputs": [],
   "source": [
    "## mean of this new column - 0.00431668792308447"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "501b1f11-213e-41a7-b8c2-01b6b30c4d80",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 10193 entries, 0 to 10192\n",
      "Data columns (total 54 columns):\n",
      " #   Column                    Non-Null Count  Dtype  \n",
      "---  ------                    --------------  -----  \n",
      " 0   TXN_DATE_TIME             10000 non-null  object \n",
      " 1   TRANSACTION_ID            10000 non-null  object \n",
      " 2   CUSTOMER_ID               10000 non-null  object \n",
      " 3   POLICY_NUMBER             10000 non-null  object \n",
      " 4   POLICY_EFF_DT             10000 non-null  object \n",
      " 5   LOSS_DT                   10000 non-null  object \n",
      " 6   REPORT_DT                 10000 non-null  object \n",
      " 7   INSURANCE_TYPE            10000 non-null  object \n",
      " 8   PREMIUM_AMOUNT            10000 non-null  float64\n",
      " 9   CLAIM_AMOUNT              10000 non-null  float64\n",
      " 10  CUSTOMER_NAME             10000 non-null  object \n",
      " 11  ADDRESS_LINE1_x           10000 non-null  object \n",
      " 12  ADDRESS_LINE2_x           1495 non-null   object \n",
      " 13  CITY_x                    9946 non-null   object \n",
      " 14  STATE_x                   10000 non-null  object \n",
      " 15  POSTAL_CODE_x             10000 non-null  float64\n",
      " 16  SSN                       10000 non-null  object \n",
      " 17  MARITAL_STATUS            10000 non-null  object \n",
      " 18  AGE                       10000 non-null  float64\n",
      " 19  TENURE                    10000 non-null  float64\n",
      " 20  EMPLOYMENT_STATUS         10000 non-null  object \n",
      " 21  NO_OF_FAMILY_MEMBERS      10000 non-null  float64\n",
      " 22  RISK_SEGMENTATION         10000 non-null  object \n",
      " 23  HOUSE_TYPE                10000 non-null  object \n",
      " 24  SOCIAL_CLASS              10000 non-null  object \n",
      " 25  ROUTING_NUMBER            10000 non-null  float64\n",
      " 26  ACCT_NUMBER               10000 non-null  object \n",
      " 27  CUSTOMER_EDUCATION_LEVEL  9471 non-null   object \n",
      " 28  CLAIM_STATUS              10000 non-null  object \n",
      " 29  INCIDENT_SEVERITY         10000 non-null  object \n",
      " 30  AUTHORITY_CONTACTED       10000 non-null  object \n",
      " 31  ANY_INJURY                10000 non-null  float64\n",
      " 32  POLICE_REPORT_AVAILABLE   10000 non-null  float64\n",
      " 33  INCIDENT_STATE            10000 non-null  object \n",
      " 34  INCIDENT_CITY             9954 non-null   object \n",
      " 35  INCIDENT_HOUR_OF_THE_DAY  10000 non-null  float64\n",
      " 36  AGENT_ID                  10000 non-null  object \n",
      " 37  VENDOR_ID                 6948 non-null   object \n",
      " 38  AGENT_NAME                10000 non-null  object \n",
      " 39  DATE_OF_JOINING           10000 non-null  object \n",
      " 40  ADDRESS_LINE1_y           10000 non-null  object \n",
      " 41  ADDRESS_LINE2_y           1451 non-null   object \n",
      " 42  CITY_y                    9946 non-null   object \n",
      " 43  STATE_y                   10000 non-null  object \n",
      " 44  POSTAL_CODE_y             10000 non-null  float64\n",
      " 45  EMP_ROUTING_NUMBER        10000 non-null  float64\n",
      " 46  EMP_ACCT_NUMBER           10000 non-null  object \n",
      " 47  VENDOR_NAME               6948 non-null   object \n",
      " 48  ADDRESS_LINE1             6948 non-null   object \n",
      " 49  ADDRESS_LINE2             1175 non-null   object \n",
      " 50  CITY                      6903 non-null   object \n",
      " 51  STATE                     6948 non-null   object \n",
      " 52  POSTAL_CODE               6948 non-null   float64\n",
      " 53  Colocation                10193 non-null  int64  \n",
      "dtypes: float64(13), int64(1), object(40)\n",
      "memory usage: 4.3+ MB\n"
     ]
    }
   ],
   "source": [
    "## 5 -: Data entry error\n",
    "\n",
    "doc2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "d54ae842-ff51-4f8a-8989-c2ca47bdcd59",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       Police\n",
       "1    Ambulance\n",
       "2       Police\n",
       "3    Ambulance\n",
       "4    Ambulance\n",
       "Name: AUTHORITY_CONTACTED, dtype: object"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2.AUTHORITY_CONTACTED.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "6ab9a295-e14b-4b12-89a4-86de4f37dc96",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Updating “AUTHORITY_CONTACTED” to Police\n",
    "doc2.loc[(doc2['POLICE_REPORT_AVAILABLE'] == '1','AUTHORITY_CONTACTED')] = 'police'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "b0e6de9b-0985-4ea6-b5c0-78bcf837f81c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AUTHORITY_CONTACTED</th>\n",
       "      <th>POLICE_REPORT_AVAILABLE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Police</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Ambulance</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Police</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Ambulance</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Ambulance</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  AUTHORITY_CONTACTED  POLICE_REPORT_AVAILABLE\n",
       "0              Police                      1.0\n",
       "1           Ambulance                      1.0\n",
       "2              Police                      0.0\n",
       "3           Ambulance                      1.0\n",
       "4           Ambulance                      1.0"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2[['AUTHORITY_CONTACTED', 'POLICE_REPORT_AVAILABLE']].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "eb787e51-08de-476b-b083-7de7b53fbe81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Ambulance    4082\n",
       "Police       2982\n",
       "None         1945\n",
       "Other         991\n",
       "Name: AUTHORITY_CONTACTED, dtype: int64"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2.AUTHORITY_CONTACTED.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "2bbd047a-e7b7-4709-882f-e726daad5606",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER POLICY_EFF_DT  \\\n",
      "0        2020-06-01    TXN00000001   A00003822   PLC00008468    2015-06-23   \n",
      "1        2020-07-25    TXN00001387   A00005010   PLC00003215    2013-06-09   \n",
      "2        2021-06-08    TXN00009413   A00004104   PLC00006793    2013-02-09   \n",
      "3        2020-11-16    TXN00004165   A00005167   PLC00007395    2017-11-29   \n",
      "4        2020-06-15    TXN00000392   A00004444   PLC00006287    2011-09-24   \n",
      "...             ...            ...         ...           ...           ...   \n",
      "10188           NaT            NaN         NaN           NaN           NaN   \n",
      "10189           NaT            NaN         NaN           NaN           NaN   \n",
      "10190           NaT            NaN         NaN           NaN           NaN   \n",
      "10191           NaT            NaN         NaN           NaN           NaN   \n",
      "10192           NaT            NaN         NaN           NaN           NaN   \n",
      "\n",
      "          LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  CLAIM_AMOUNT  \\\n",
      "0      2020-05-16  2020-05-21         Health          157.13        9000.0   \n",
      "1      2020-07-13  2020-07-18          Motor          102.83       10000.0   \n",
      "2      2021-06-05  2021-06-05         Health          141.61        4000.0   \n",
      "3      2020-11-08  2020-11-11         Travel           67.68        3000.0   \n",
      "4      2020-05-29  2020-06-03           Life           78.38       56000.0   \n",
      "...           ...         ...            ...             ...           ...   \n",
      "10188         NaN         NaN            NaN             NaN           NaN   \n",
      "10189         NaN         NaN            NaN             NaN           NaN   \n",
      "10190         NaN         NaN            NaN             NaN           NaN   \n",
      "10191         NaN         NaN            NaN             NaN           NaN   \n",
      "10192         NaN         NaN            NaN             NaN           NaN   \n",
      "\n",
      "       ... POSTAL_CODE_y EMP_ROUTING_NUMBER     EMP_ACCT_NUMBER  \\\n",
      "0      ...       37217.0         35441155.0  LRZO53254369804934   \n",
      "1      ...       40291.0        106847442.0  IYLB01551123255113   \n",
      "2      ...       99503.0         50013115.0  VWII94517745930110   \n",
      "3      ...        2721.0         10623451.0  CPIE92788049884734   \n",
      "4      ...       73114.0        111257001.0  LQRX58976259076318   \n",
      "...    ...           ...                ...                 ...   \n",
      "10188  ...           NaN                NaN                 NaN   \n",
      "10189  ...           NaN                NaN                 NaN   \n",
      "10190  ...           NaN                NaN                 NaN   \n",
      "10191  ...           NaN                NaN                 NaN   \n",
      "10192  ...           NaN                NaN                 NaN   \n",
      "\n",
      "                           VENDOR_NAME              ADDRESS_LINE1  \\\n",
      "0                           Ramsey Inc       3114 West 20th Court   \n",
      "1                           Ramsey Inc       3114 West 20th Court   \n",
      "2                           Ramsey Inc       3114 West 20th Court   \n",
      "3                           Ramsey Inc       3114 West 20th Court   \n",
      "4                           Ramsey Inc       3114 West 20th Court   \n",
      "...                                ...                        ...   \n",
      "10188         Barnes, Moore and Morris   2375 South School Avenue   \n",
      "10189         Smith, Simmons and Perez      314 South 17th Street   \n",
      "10190      Cooper, Jones and Maldonado  735 West Treadwell Street   \n",
      "10191  Hutchinson, Matthews and Wilcox  1318 4th Street Southwest   \n",
      "10192                    Rhodes-Mendez      1689 Fisher Pond Road   \n",
      "\n",
      "       ADDRESS_LINE2               CITY STATE  POSTAL_CODE  Colocation  \n",
      "0                NaN        Panama City    FL      32405.0           0  \n",
      "1                NaN        Panama City    FL      32405.0           0  \n",
      "2                NaN        Panama City    FL      32405.0           0  \n",
      "3                NaN        Panama City    FL      32405.0           0  \n",
      "4                NaN        Panama City    FL      32405.0           0  \n",
      "...              ...                ...   ...          ...         ...  \n",
      "10188             #5       Fayetteville    AR      72701.0           0  \n",
      "10189            NaN          Nashville    TN      37206.0           0  \n",
      "10190            #33       Fayetteville    AR      72701.0           0  \n",
      "10191            NaN         Washington    DC      20024.0           0  \n",
      "10192            NaN  Saint Albans City    VT       5478.0           0  \n",
      "\n",
      "[10193 rows x 54 columns]\n"
     ]
    }
   ],
   "source": [
    "## 6-: CLAIM_DEVIATION\n",
    "\n",
    "doc2['TXN_DATE_TIME'] = pd.to_datetime(doc2['TXN_DATE_TIME']).dt.date\n",
    "print(doc2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "64d8fda4-8dfc-4d43-830d-199e94363a07",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Timestamp('2021-06-30 00:00:00')"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " doc2['TXN_DATE_TIME'] = pd.to_datetime(doc2['TXN_DATE_TIME'])\n",
    " doc2['TXN_DATE_TIME'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "9db92b68-6bb8-4f4f-8179-423c5e466593",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Timestamp('2020-06-01 00:00:00')"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2['TXN_DATE_TIME'].min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "31fe56bf-cbe1-4ea6-9a57-1a43d549bc35",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "16667.852437417656"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "avg_claim_amt = doc2.loc[(doc2['TXN_DATE_TIME'] > '2021-05-31') & (doc2['TXN_DATE_TIME'] < '2021-06-30')]\n",
    "avg_claim_amt['CLAIM_AMOUNT'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "f484afcc-8d13-4c10-9726-1f879d1d1d78",
   "metadata": {},
   "outputs": [],
   "source": [
    "## Average Claim Amount = 16667.852437417656"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "20d02f26-afd0-41d6-854b-4efa0f1a6852",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>EMP_ROUTING_NUMBER</th>\n",
       "      <th>EMP_ACCT_NUMBER</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>Colocation</th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>35441155.0</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.851984</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-07-25</td>\n",
       "      <td>TXN00001387</td>\n",
       "      <td>A00005010</td>\n",
       "      <td>PLC00003215</td>\n",
       "      <td>2013-06-09</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>2020-07-18</td>\n",
       "      <td>Motor</td>\n",
       "      <td>102.83</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>106847442.0</td>\n",
       "      <td>IYLB01551123255113</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.666785</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-06-08</td>\n",
       "      <td>TXN00009413</td>\n",
       "      <td>A00004104</td>\n",
       "      <td>PLC00006793</td>\n",
       "      <td>2013-02-09</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>Health</td>\n",
       "      <td>141.61</td>\n",
       "      <td>4000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>50013115.0</td>\n",
       "      <td>VWII94517745930110</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>4.166963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-11-16</td>\n",
       "      <td>TXN00004165</td>\n",
       "      <td>A00005167</td>\n",
       "      <td>PLC00007395</td>\n",
       "      <td>2017-11-29</td>\n",
       "      <td>2020-11-08</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>Travel</td>\n",
       "      <td>67.68</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>10623451.0</td>\n",
       "      <td>CPIE92788049884734</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5.555951</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-06-15</td>\n",
       "      <td>TXN00000392</td>\n",
       "      <td>A00004444</td>\n",
       "      <td>PLC00006287</td>\n",
       "      <td>2011-09-24</td>\n",
       "      <td>2020-05-29</td>\n",
       "      <td>2020-06-03</td>\n",
       "      <td>Life</td>\n",
       "      <td>78.38</td>\n",
       "      <td>56000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>111257001.0</td>\n",
       "      <td>LQRX58976259076318</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.297640</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10188</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Barnes, Moore and Morris</td>\n",
       "      <td>2375 South School Avenue</td>\n",
       "      <td>#5</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10189</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Smith, Simmons and Perez</td>\n",
       "      <td>314 South 17th Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37206.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10190</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Cooper, Jones and Maldonado</td>\n",
       "      <td>735 West Treadwell Street</td>\n",
       "      <td>#33</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10191</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hutchinson, Matthews and Wilcox</td>\n",
       "      <td>1318 4th Street Southwest</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Washington</td>\n",
       "      <td>DC</td>\n",
       "      <td>20024.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10192</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Rhodes-Mendez</td>\n",
       "      <td>1689 Fisher Pond Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Saint Albans City</td>\n",
       "      <td>VT</td>\n",
       "      <td>5478.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10193 rows × 55 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER POLICY_EFF_DT  \\\n",
       "0        2020-06-01    TXN00000001   A00003822   PLC00008468    2015-06-23   \n",
       "1        2020-07-25    TXN00001387   A00005010   PLC00003215    2013-06-09   \n",
       "2        2021-06-08    TXN00009413   A00004104   PLC00006793    2013-02-09   \n",
       "3        2020-11-16    TXN00004165   A00005167   PLC00007395    2017-11-29   \n",
       "4        2020-06-15    TXN00000392   A00004444   PLC00006287    2011-09-24   \n",
       "...             ...            ...         ...           ...           ...   \n",
       "10188           NaT            NaN         NaN           NaN           NaN   \n",
       "10189           NaT            NaN         NaN           NaN           NaN   \n",
       "10190           NaT            NaN         NaN           NaN           NaN   \n",
       "10191           NaT            NaN         NaN           NaN           NaN   \n",
       "10192           NaT            NaN         NaN           NaN           NaN   \n",
       "\n",
       "          LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  CLAIM_AMOUNT  \\\n",
       "0      2020-05-16  2020-05-21         Health          157.13        9000.0   \n",
       "1      2020-07-13  2020-07-18          Motor          102.83       10000.0   \n",
       "2      2021-06-05  2021-06-05         Health          141.61        4000.0   \n",
       "3      2020-11-08  2020-11-11         Travel           67.68        3000.0   \n",
       "4      2020-05-29  2020-06-03           Life           78.38       56000.0   \n",
       "...           ...         ...            ...             ...           ...   \n",
       "10188         NaN         NaN            NaN             NaN           NaN   \n",
       "10189         NaN         NaN            NaN             NaN           NaN   \n",
       "10190         NaN         NaN            NaN             NaN           NaN   \n",
       "10191         NaN         NaN            NaN             NaN           NaN   \n",
       "10192         NaN         NaN            NaN             NaN           NaN   \n",
       "\n",
       "       ... EMP_ROUTING_NUMBER     EMP_ACCT_NUMBER  \\\n",
       "0      ...         35441155.0  LRZO53254369804934   \n",
       "1      ...        106847442.0  IYLB01551123255113   \n",
       "2      ...         50013115.0  VWII94517745930110   \n",
       "3      ...         10623451.0  CPIE92788049884734   \n",
       "4      ...        111257001.0  LQRX58976259076318   \n",
       "...    ...                ...                 ...   \n",
       "10188  ...                NaN                 NaN   \n",
       "10189  ...                NaN                 NaN   \n",
       "10190  ...                NaN                 NaN   \n",
       "10191  ...                NaN                 NaN   \n",
       "10192  ...                NaN                 NaN   \n",
       "\n",
       "                           VENDOR_NAME              ADDRESS_LINE1  \\\n",
       "0                           Ramsey Inc       3114 West 20th Court   \n",
       "1                           Ramsey Inc       3114 West 20th Court   \n",
       "2                           Ramsey Inc       3114 West 20th Court   \n",
       "3                           Ramsey Inc       3114 West 20th Court   \n",
       "4                           Ramsey Inc       3114 West 20th Court   \n",
       "...                                ...                        ...   \n",
       "10188         Barnes, Moore and Morris   2375 South School Avenue   \n",
       "10189         Smith, Simmons and Perez      314 South 17th Street   \n",
       "10190      Cooper, Jones and Maldonado  735 West Treadwell Street   \n",
       "10191  Hutchinson, Matthews and Wilcox  1318 4th Street Southwest   \n",
       "10192                    Rhodes-Mendez      1689 Fisher Pond Road   \n",
       "\n",
       "      ADDRESS_LINE2               CITY STATE POSTAL_CODE  Colocation  \\\n",
       "0               NaN        Panama City    FL     32405.0           0   \n",
       "1               NaN        Panama City    FL     32405.0           0   \n",
       "2               NaN        Panama City    FL     32405.0           0   \n",
       "3               NaN        Panama City    FL     32405.0           0   \n",
       "4               NaN        Panama City    FL     32405.0           0   \n",
       "...             ...                ...   ...         ...         ...   \n",
       "10188            #5       Fayetteville    AR     72701.0           0   \n",
       "10189           NaN          Nashville    TN     37206.0           0   \n",
       "10190           #33       Fayetteville    AR     72701.0           0   \n",
       "10191           NaN         Washington    DC     20024.0           0   \n",
       "10192           NaN  Saint Albans City    VT      5478.0           0   \n",
       "\n",
       "       CLAIM_DEVIATION  \n",
       "0             1.851984  \n",
       "1             1.666785  \n",
       "2             4.166963  \n",
       "3             5.555951  \n",
       "4             0.297640  \n",
       "...                ...  \n",
       "10188              NaN  \n",
       "10189              NaN  \n",
       "10190              NaN  \n",
       "10191              NaN  \n",
       "10192              NaN  \n",
       "\n",
       "[10193 rows x 55 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2['CLAIM_DEVIATION'] =avg_claim_amt['CLAIM_AMOUNT'].mean()/doc2['CLAIM_AMOUNT']\n",
    "doc2\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "7ec362b2-de0a-49c8-80de-cc98d331cc92",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>...</th>\n",
       "      <th>EMP_ACCT_NUMBER</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>Colocation</th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "      <th>claim_Deviation_value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2020-06-01</td>\n",
       "      <td>TXN00000001</td>\n",
       "      <td>A00003822</td>\n",
       "      <td>PLC00008468</td>\n",
       "      <td>2015-06-23</td>\n",
       "      <td>2020-05-16</td>\n",
       "      <td>2020-05-21</td>\n",
       "      <td>Health</td>\n",
       "      <td>157.13</td>\n",
       "      <td>9000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>LRZO53254369804934</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.851984</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2020-07-25</td>\n",
       "      <td>TXN00001387</td>\n",
       "      <td>A00005010</td>\n",
       "      <td>PLC00003215</td>\n",
       "      <td>2013-06-09</td>\n",
       "      <td>2020-07-13</td>\n",
       "      <td>2020-07-18</td>\n",
       "      <td>Motor</td>\n",
       "      <td>102.83</td>\n",
       "      <td>10000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>IYLB01551123255113</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.666785</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2021-06-08</td>\n",
       "      <td>TXN00009413</td>\n",
       "      <td>A00004104</td>\n",
       "      <td>PLC00006793</td>\n",
       "      <td>2013-02-09</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>2021-06-05</td>\n",
       "      <td>Health</td>\n",
       "      <td>141.61</td>\n",
       "      <td>4000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>VWII94517745930110</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>4.166963</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2020-11-16</td>\n",
       "      <td>TXN00004165</td>\n",
       "      <td>A00005167</td>\n",
       "      <td>PLC00007395</td>\n",
       "      <td>2017-11-29</td>\n",
       "      <td>2020-11-08</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>Travel</td>\n",
       "      <td>67.68</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>CPIE92788049884734</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>5.555951</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2020-06-15</td>\n",
       "      <td>TXN00000392</td>\n",
       "      <td>A00004444</td>\n",
       "      <td>PLC00006287</td>\n",
       "      <td>2011-09-24</td>\n",
       "      <td>2020-05-29</td>\n",
       "      <td>2020-06-03</td>\n",
       "      <td>Life</td>\n",
       "      <td>78.38</td>\n",
       "      <td>56000.0</td>\n",
       "      <td>...</td>\n",
       "      <td>LQRX58976259076318</td>\n",
       "      <td>Ramsey Inc</td>\n",
       "      <td>3114 West 20th Court</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Panama City</td>\n",
       "      <td>FL</td>\n",
       "      <td>32405.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.297640</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10188</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Barnes, Moore and Morris</td>\n",
       "      <td>2375 South School Avenue</td>\n",
       "      <td>#5</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10189</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Smith, Simmons and Perez</td>\n",
       "      <td>314 South 17th Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>TN</td>\n",
       "      <td>37206.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10190</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Cooper, Jones and Maldonado</td>\n",
       "      <td>735 West Treadwell Street</td>\n",
       "      <td>#33</td>\n",
       "      <td>Fayetteville</td>\n",
       "      <td>AR</td>\n",
       "      <td>72701.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10191</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hutchinson, Matthews and Wilcox</td>\n",
       "      <td>1318 4th Street Southwest</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Washington</td>\n",
       "      <td>DC</td>\n",
       "      <td>20024.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10192</th>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Rhodes-Mendez</td>\n",
       "      <td>1689 Fisher Pond Road</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Saint Albans City</td>\n",
       "      <td>VT</td>\n",
       "      <td>5478.0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10193 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      TXN_DATE_TIME TRANSACTION_ID CUSTOMER_ID POLICY_NUMBER POLICY_EFF_DT  \\\n",
       "0        2020-06-01    TXN00000001   A00003822   PLC00008468    2015-06-23   \n",
       "1        2020-07-25    TXN00001387   A00005010   PLC00003215    2013-06-09   \n",
       "2        2021-06-08    TXN00009413   A00004104   PLC00006793    2013-02-09   \n",
       "3        2020-11-16    TXN00004165   A00005167   PLC00007395    2017-11-29   \n",
       "4        2020-06-15    TXN00000392   A00004444   PLC00006287    2011-09-24   \n",
       "...             ...            ...         ...           ...           ...   \n",
       "10188           NaT            NaN         NaN           NaN           NaN   \n",
       "10189           NaT            NaN         NaN           NaN           NaN   \n",
       "10190           NaT            NaN         NaN           NaN           NaN   \n",
       "10191           NaT            NaN         NaN           NaN           NaN   \n",
       "10192           NaT            NaN         NaN           NaN           NaN   \n",
       "\n",
       "          LOSS_DT   REPORT_DT INSURANCE_TYPE  PREMIUM_AMOUNT  CLAIM_AMOUNT  \\\n",
       "0      2020-05-16  2020-05-21         Health          157.13        9000.0   \n",
       "1      2020-07-13  2020-07-18          Motor          102.83       10000.0   \n",
       "2      2021-06-05  2021-06-05         Health          141.61        4000.0   \n",
       "3      2020-11-08  2020-11-11         Travel           67.68        3000.0   \n",
       "4      2020-05-29  2020-06-03           Life           78.38       56000.0   \n",
       "...           ...         ...            ...             ...           ...   \n",
       "10188         NaN         NaN            NaN             NaN           NaN   \n",
       "10189         NaN         NaN            NaN             NaN           NaN   \n",
       "10190         NaN         NaN            NaN             NaN           NaN   \n",
       "10191         NaN         NaN            NaN             NaN           NaN   \n",
       "10192         NaN         NaN            NaN             NaN           NaN   \n",
       "\n",
       "       ...     EMP_ACCT_NUMBER                      VENDOR_NAME  \\\n",
       "0      ...  LRZO53254369804934                       Ramsey Inc   \n",
       "1      ...  IYLB01551123255113                       Ramsey Inc   \n",
       "2      ...  VWII94517745930110                       Ramsey Inc   \n",
       "3      ...  CPIE92788049884734                       Ramsey Inc   \n",
       "4      ...  LQRX58976259076318                       Ramsey Inc   \n",
       "...    ...                 ...                              ...   \n",
       "10188  ...                 NaN         Barnes, Moore and Morris   \n",
       "10189  ...                 NaN         Smith, Simmons and Perez   \n",
       "10190  ...                 NaN      Cooper, Jones and Maldonado   \n",
       "10191  ...                 NaN  Hutchinson, Matthews and Wilcox   \n",
       "10192  ...                 NaN                    Rhodes-Mendez   \n",
       "\n",
       "                   ADDRESS_LINE1 ADDRESS_LINE2               CITY  STATE  \\\n",
       "0           3114 West 20th Court           NaN        Panama City     FL   \n",
       "1           3114 West 20th Court           NaN        Panama City     FL   \n",
       "2           3114 West 20th Court           NaN        Panama City     FL   \n",
       "3           3114 West 20th Court           NaN        Panama City     FL   \n",
       "4           3114 West 20th Court           NaN        Panama City     FL   \n",
       "...                          ...           ...                ...    ...   \n",
       "10188   2375 South School Avenue            #5       Fayetteville     AR   \n",
       "10189      314 South 17th Street           NaN          Nashville     TN   \n",
       "10190  735 West Treadwell Street           #33       Fayetteville     AR   \n",
       "10191  1318 4th Street Southwest           NaN         Washington     DC   \n",
       "10192      1689 Fisher Pond Road           NaN  Saint Albans City     VT   \n",
       "\n",
       "      POSTAL_CODE Colocation  CLAIM_DEVIATION  claim_Deviation_value  \n",
       "0         32405.0          0         1.851984                      0  \n",
       "1         32405.0          0         1.666785                      0  \n",
       "2         32405.0          0         4.166963                      0  \n",
       "3         32405.0          0         5.555951                      0  \n",
       "4         32405.0          0         0.297640                      1  \n",
       "...           ...        ...              ...                    ...  \n",
       "10188     72701.0          0              NaN                      0  \n",
       "10189     37206.0          0              NaN                      0  \n",
       "10190     72701.0          0              NaN                      0  \n",
       "10191     20024.0          0              NaN                      0  \n",
       "10192      5478.0          0              NaN                      0  \n",
       "\n",
       "[10193 rows x 56 columns]"
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2['CLAIM_DEVIATION'] = doc2['CLAIM_DEVIATION'].astype(float)\n",
    "doc2['claim_Deviation_value'] = doc2['CLAIM_DEVIATION'].apply(lambda x: '1' if x < 0.5 else '0')\n",
    "doc2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "afeff527-ef8e-41b4-84c2-5d6bc695a0ea",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "      <th>claim_Deviation_value</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>10188</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10189</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10190</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10191</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10192</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       CLAIM_DEVIATION claim_Deviation_value\n",
       "10188              NaN                     0\n",
       "10189              NaN                     0\n",
       "10190              NaN                     0\n",
       "10191              NaN                     0\n",
       "10192              NaN                     0"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## If the value Less Than 0.5 THEN CLAIM_DEVIATION = 1 else '0'\n",
    "doc2[['CLAIM_DEVIATION', 'claim_Deviation_value']].tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "72beb348-f9d0-412f-95de-c1b73ec6850d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 10193 entries, 0 to 10192\n",
      "Data columns (total 56 columns):\n",
      " #   Column                    Non-Null Count  Dtype         \n",
      "---  ------                    --------------  -----         \n",
      " 0   TXN_DATE_TIME             10000 non-null  datetime64[ns]\n",
      " 1   TRANSACTION_ID            10000 non-null  object        \n",
      " 2   CUSTOMER_ID               10000 non-null  object        \n",
      " 3   POLICY_NUMBER             10000 non-null  object        \n",
      " 4   POLICY_EFF_DT             10000 non-null  object        \n",
      " 5   LOSS_DT                   10000 non-null  object        \n",
      " 6   REPORT_DT                 10000 non-null  object        \n",
      " 7   INSURANCE_TYPE            10000 non-null  object        \n",
      " 8   PREMIUM_AMOUNT            10000 non-null  float64       \n",
      " 9   CLAIM_AMOUNT              10000 non-null  float64       \n",
      " 10  CUSTOMER_NAME             10000 non-null  object        \n",
      " 11  ADDRESS_LINE1_x           10000 non-null  object        \n",
      " 12  ADDRESS_LINE2_x           1495 non-null   object        \n",
      " 13  CITY_x                    9946 non-null   object        \n",
      " 14  STATE_x                   10000 non-null  object        \n",
      " 15  POSTAL_CODE_x             10000 non-null  float64       \n",
      " 16  SSN                       10000 non-null  object        \n",
      " 17  MARITAL_STATUS            10000 non-null  object        \n",
      " 18  AGE                       10000 non-null  float64       \n",
      " 19  TENURE                    10000 non-null  float64       \n",
      " 20  EMPLOYMENT_STATUS         10000 non-null  object        \n",
      " 21  NO_OF_FAMILY_MEMBERS      10000 non-null  float64       \n",
      " 22  RISK_SEGMENTATION         10000 non-null  object        \n",
      " 23  HOUSE_TYPE                10000 non-null  object        \n",
      " 24  SOCIAL_CLASS              10000 non-null  object        \n",
      " 25  ROUTING_NUMBER            10000 non-null  float64       \n",
      " 26  ACCT_NUMBER               10000 non-null  object        \n",
      " 27  CUSTOMER_EDUCATION_LEVEL  9471 non-null   object        \n",
      " 28  CLAIM_STATUS              10000 non-null  object        \n",
      " 29  INCIDENT_SEVERITY         10000 non-null  object        \n",
      " 30  AUTHORITY_CONTACTED       10000 non-null  object        \n",
      " 31  ANY_INJURY                10000 non-null  float64       \n",
      " 32  POLICE_REPORT_AVAILABLE   10000 non-null  float64       \n",
      " 33  INCIDENT_STATE            10000 non-null  object        \n",
      " 34  INCIDENT_CITY             9954 non-null   object        \n",
      " 35  INCIDENT_HOUR_OF_THE_DAY  10000 non-null  float64       \n",
      " 36  AGENT_ID                  10000 non-null  object        \n",
      " 37  VENDOR_ID                 6948 non-null   object        \n",
      " 38  AGENT_NAME                10000 non-null  object        \n",
      " 39  DATE_OF_JOINING           10000 non-null  object        \n",
      " 40  ADDRESS_LINE1_y           10000 non-null  object        \n",
      " 41  ADDRESS_LINE2_y           1451 non-null   object        \n",
      " 42  CITY_y                    9946 non-null   object        \n",
      " 43  STATE_y                   10000 non-null  object        \n",
      " 44  POSTAL_CODE_y             10000 non-null  float64       \n",
      " 45  EMP_ROUTING_NUMBER        10000 non-null  float64       \n",
      " 46  EMP_ACCT_NUMBER           10000 non-null  object        \n",
      " 47  VENDOR_NAME               6948 non-null   object        \n",
      " 48  ADDRESS_LINE1             6948 non-null   object        \n",
      " 49  ADDRESS_LINE2             1175 non-null   object        \n",
      " 50  CITY                      6903 non-null   object        \n",
      " 51  STATE                     6948 non-null   object        \n",
      " 52  POSTAL_CODE               6948 non-null   float64       \n",
      " 53  Colocation                10193 non-null  int64         \n",
      " 54  CLAIM_DEVIATION           10000 non-null  float64       \n",
      " 55  claim_Deviation_value     10193 non-null  object        \n",
      "dtypes: datetime64[ns](1), float64(14), int64(1), object(40)\n",
      "memory usage: 4.4+ MB\n"
     ]
    }
   ],
   "source": [
    "## 7-: Agents who have worked on more than 2 types of Insurance Claims\n",
    "doc2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d802152e-5966-45d7-8146-0268e83f29a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>AGENT_NAME</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5429</th>\n",
       "      <td>AGENT00723</td>\n",
       "      <td>Thomas Phariss</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2909</th>\n",
       "      <td>AGENT00385</td>\n",
       "      <td>Sarah Pearce</td>\n",
       "      <td>5000.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3002</th>\n",
       "      <td>AGENT00396</td>\n",
       "      <td>Majorie Holt</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1081</th>\n",
       "      <td>AGENT00147</td>\n",
       "      <td>Brian Webb</td>\n",
       "      <td>700.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>AGENT00224</td>\n",
       "      <td>Evelyn Ortiz</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3149</th>\n",
       "      <td>AGENT00414</td>\n",
       "      <td>Christine Carter</td>\n",
       "      <td>38000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3148</th>\n",
       "      <td>AGENT00414</td>\n",
       "      <td>Christine Carter</td>\n",
       "      <td>26000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3147</th>\n",
       "      <td>AGENT00414</td>\n",
       "      <td>Christine Carter</td>\n",
       "      <td>20000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3146</th>\n",
       "      <td>AGENT00414</td>\n",
       "      <td>Christine Carter</td>\n",
       "      <td>18000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8942</th>\n",
       "      <td>AGENT01200</td>\n",
       "      <td>Virginia Stachura</td>\n",
       "      <td>56000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8943 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        AGENT_ID         AGENT_NAME  CLAIM_AMOUNT  INSURANCE_TYPE\n",
       "5429  AGENT00723     Thomas Phariss        5000.0               4\n",
       "2909  AGENT00385       Sarah Pearce        5000.0               4\n",
       "3002  AGENT00396       Majorie Holt        3000.0               4\n",
       "1081  AGENT00147         Brian Webb         700.0               4\n",
       "1666  AGENT00224       Evelyn Ortiz        3000.0               4\n",
       "...          ...                ...           ...             ...\n",
       "3149  AGENT00414   Christine Carter       38000.0               1\n",
       "3148  AGENT00414   Christine Carter       26000.0               1\n",
       "3147  AGENT00414   Christine Carter       20000.0               1\n",
       "3146  AGENT00414   Christine Carter       18000.0               1\n",
       "8942  AGENT01200  Virginia Stachura       56000.0               1\n",
       "\n",
       "[8943 rows x 4 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "agent=doc2.groupby(['AGENT_ID', 'AGENT_NAME', 'CLAIM_AMOUNT'])['INSURANCE_TYPE'].count().reset_index().sort_values('INSURANCE_TYPE', ascending= False,axis=0)\n",
    "agent"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "f2323149-c36d-4725-8426-b589a7592f37",
   "metadata": {},
   "outputs": [],
   "source": [
    "agent['INSURANCE_TYPE'] = agent['INSURANCE_TYPE'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "ee8e51ed-cbee-4bc5-a125-5465b26dee15",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>AGENT_NAME</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5963</th>\n",
       "      <td>AGENT00794</td>\n",
       "      <td>Gladys Parsons</td>\n",
       "      <td>20000.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5163</th>\n",
       "      <td>AGENT00688</td>\n",
       "      <td>Glenda Briney</td>\n",
       "      <td>20000.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6641</th>\n",
       "      <td>AGENT00889</td>\n",
       "      <td>John Martin</td>\n",
       "      <td>20000.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5660</th>\n",
       "      <td>AGENT00752</td>\n",
       "      <td>Trevor Bishop</td>\n",
       "      <td>19000.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8435</th>\n",
       "      <td>AGENT01125</td>\n",
       "      <td>Frank Valenzuela</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        AGENT_ID        AGENT_NAME  CLAIM_AMOUNT  INSURANCE_TYPE\n",
       "5963  AGENT00794    Gladys Parsons       20000.0               3\n",
       "5163  AGENT00688     Glenda Briney       20000.0               3\n",
       "6641  AGENT00889       John Martin       20000.0               3\n",
       "5660  AGENT00752     Trevor Bishop       19000.0               3\n",
       "8435  AGENT01125  Frank Valenzuela       15000.0               3"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "agent_insurance_claim = agent[agent['INSURANCE_TYPE']>2].sort_values('CLAIM_AMOUNT', ascending= False)\n",
    "agent_insurance_claim.head()\n",
    "## All Agents who have worked on more than 2 types of Insurance Claims"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "333695f5-2bda-497c-918a-77f1df6eaa16",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>252455.73</td>\n",
       "      <td>Health</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>125621.22</td>\n",
       "      <td>Life</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15191.42</td>\n",
       "      <td>Mobile</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>165391.98</td>\n",
       "      <td>Motor</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>202285.83</td>\n",
       "      <td>Property</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>124139.77</td>\n",
       "      <td>Travel</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   PREMIUM_AMOUNT INSURANCE_TYPE\n",
       "0       252455.73         Health\n",
       "1       125621.22           Life\n",
       "2        15191.42         Mobile\n",
       "3       165391.98          Motor\n",
       "4       202285.83       Property\n",
       "5       124139.77         Travel"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## 08 -: overall change in % of the Premium Amount\n",
    "\n",
    "overall_change = pd.DataFrame(doc2.groupby(['INSURANCE_TYPE'])['PREMIUM_AMOUNT'].sum())\n",
    "overall_change['INSURANCE_TYPE'] = overall_change.index\n",
    "overall_change.reset_index(drop= True, inplace= True)\n",
    "overall_change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "f231c20a-b3b1-4413-95d1-27584684554d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "885085.95"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "overall_change['PREMIUM_AMOUNT'].sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "2741f62e-9c45-4e33-9cb0-79f52c9fb710",
   "metadata": {},
   "outputs": [],
   "source": [
    "overall_change['PERCENTAGE'] = (overall_change['PREMIUM_AMOUNT']/overall_change['PREMIUM_AMOUNT'].sum())*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "7cf27fe6-f7d7-4d30-b219-e6f502fbb350",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PERCENTAGE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>252455.73</td>\n",
       "      <td>Health</td>\n",
       "      <td>28.523301</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>125621.22</td>\n",
       "      <td>Life</td>\n",
       "      <td>14.193110</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15191.42</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>1.716378</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>165391.98</td>\n",
       "      <td>Motor</td>\n",
       "      <td>18.686545</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>202285.83</td>\n",
       "      <td>Property</td>\n",
       "      <td>22.854936</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>124139.77</td>\n",
       "      <td>Travel</td>\n",
       "      <td>14.025730</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   PREMIUM_AMOUNT INSURANCE_TYPE  PERCENTAGE\n",
       "0       252455.73         Health   28.523301\n",
       "1       125621.22           Life   14.193110\n",
       "2        15191.42         Mobile    1.716378\n",
       "3       165391.98          Motor   18.686545\n",
       "4       202285.83       Property   22.854936\n",
       "5       124139.77         Travel   14.025730"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "overall_change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "e2265fcf-7a29-43ec-a7bd-0a35cf2f676d",
   "metadata": {},
   "outputs": [],
   "source": [
    "def new_premium(row):\n",
    "    if ((row['INSURANCE_TYPE']=='Health') | (row['INSURANCE_TYPE']=='Property')):\n",
    "        val = row['PREMIUM_AMOUNT']+(0.07*row['PREMIUM_AMOUNT'])\n",
    "    elif ((row['INSURANCE_TYPE']=='Life') | (row['INSURANCE_TYPE']=='Motor')):\n",
    "        val = row['PREMIUM_AMOUNT']+(0.02*row['PREMIUM_AMOUNT'])\n",
    "    elif ((row['INSURANCE_TYPE']=='Mobile') | (row['INSURANCE_TYPE']=='Travel')):\n",
    "        val = row['PREMIUM_AMOUNT']-(0.10*row['PREMIUM_AMOUNT'])\n",
    "    return val\n",
    "\n",
    "overall_change['NEW_PREMIUM'] = overall_change.apply(new_premium, axis= 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "f1d06724-baac-49c4-aff9-53147cbad75a",
   "metadata": {},
   "outputs": [],
   "source": [
    "overall_change['NEW_PREMIUM_percentage'] = overall_change['NEW_PREMIUM']/(overall_change['NEW_PREMIUM'].sum())*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "b080785b-6bda-477d-b8be-916ab3808791",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>PERCENTAGE</th>\n",
       "      <th>NEW_PREMIUM</th>\n",
       "      <th>NEW_PREMIUM_percentage</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>252455.73</td>\n",
       "      <td>Health</td>\n",
       "      <td>28.523301</td>\n",
       "      <td>270127.6311</td>\n",
       "      <td>29.723387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>125621.22</td>\n",
       "      <td>Life</td>\n",
       "      <td>14.193110</td>\n",
       "      <td>128133.6444</td>\n",
       "      <td>14.099135</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>15191.42</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>1.716378</td>\n",
       "      <td>13672.2780</td>\n",
       "      <td>1.504424</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>165391.98</td>\n",
       "      <td>Motor</td>\n",
       "      <td>18.686545</td>\n",
       "      <td>168699.8196</td>\n",
       "      <td>18.562818</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>202285.83</td>\n",
       "      <td>Property</td>\n",
       "      <td>22.854936</td>\n",
       "      <td>216445.8381</td>\n",
       "      <td>23.816532</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>124139.77</td>\n",
       "      <td>Travel</td>\n",
       "      <td>14.025730</td>\n",
       "      <td>111725.7930</td>\n",
       "      <td>12.293704</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   PREMIUM_AMOUNT INSURANCE_TYPE  PERCENTAGE  NEW_PREMIUM  \\\n",
       "0       252455.73         Health   28.523301  270127.6311   \n",
       "1       125621.22           Life   14.193110  128133.6444   \n",
       "2        15191.42         Mobile    1.716378   13672.2780   \n",
       "3       165391.98          Motor   18.686545  168699.8196   \n",
       "4       202285.83       Property   22.854936  216445.8381   \n",
       "5       124139.77         Travel   14.025730  111725.7930   \n",
       "\n",
       "   NEW_PREMIUM_percentage  \n",
       "0               29.723387  \n",
       "1               14.099135  \n",
       "2                1.504424  \n",
       "3               18.562818  \n",
       "4               23.816532  \n",
       "5               12.293704  "
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Mobile & Travel Insurance premium are discounted by 10%\n",
    "## Health and Property Insurance premium are increased by 7%\n",
    "## Life and Motor Insurance premium are marginally increased by 2%\n",
    "\n",
    "overall_change"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "83bedc57-d653-4d7a-8fa4-3e7fc56b903f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 10193 entries, 0 to 10192\n",
      "Data columns (total 56 columns):\n",
      " #   Column                    Non-Null Count  Dtype         \n",
      "---  ------                    --------------  -----         \n",
      " 0   TXN_DATE_TIME             10000 non-null  datetime64[ns]\n",
      " 1   TRANSACTION_ID            10000 non-null  object        \n",
      " 2   CUSTOMER_ID               10000 non-null  object        \n",
      " 3   POLICY_NUMBER             10000 non-null  object        \n",
      " 4   POLICY_EFF_DT             10000 non-null  object        \n",
      " 5   LOSS_DT                   10000 non-null  object        \n",
      " 6   REPORT_DT                 10000 non-null  object        \n",
      " 7   INSURANCE_TYPE            10000 non-null  object        \n",
      " 8   PREMIUM_AMOUNT            10000 non-null  float64       \n",
      " 9   CLAIM_AMOUNT              10000 non-null  float64       \n",
      " 10  CUSTOMER_NAME             10000 non-null  object        \n",
      " 11  ADDRESS_LINE1_x           10000 non-null  object        \n",
      " 12  ADDRESS_LINE2_x           1495 non-null   object        \n",
      " 13  CITY_x                    9946 non-null   object        \n",
      " 14  STATE_x                   10000 non-null  object        \n",
      " 15  POSTAL_CODE_x             10000 non-null  float64       \n",
      " 16  SSN                       10000 non-null  object        \n",
      " 17  MARITAL_STATUS            10000 non-null  object        \n",
      " 18  AGE                       10000 non-null  float64       \n",
      " 19  TENURE                    10000 non-null  float64       \n",
      " 20  EMPLOYMENT_STATUS         10000 non-null  object        \n",
      " 21  NO_OF_FAMILY_MEMBERS      10000 non-null  float64       \n",
      " 22  RISK_SEGMENTATION         10000 non-null  object        \n",
      " 23  HOUSE_TYPE                10000 non-null  object        \n",
      " 24  SOCIAL_CLASS              10000 non-null  object        \n",
      " 25  ROUTING_NUMBER            10000 non-null  float64       \n",
      " 26  ACCT_NUMBER               10000 non-null  object        \n",
      " 27  CUSTOMER_EDUCATION_LEVEL  9471 non-null   object        \n",
      " 28  CLAIM_STATUS              10000 non-null  object        \n",
      " 29  INCIDENT_SEVERITY         10000 non-null  object        \n",
      " 30  AUTHORITY_CONTACTED       10000 non-null  object        \n",
      " 31  ANY_INJURY                10000 non-null  float64       \n",
      " 32  POLICE_REPORT_AVAILABLE   10000 non-null  float64       \n",
      " 33  INCIDENT_STATE            10000 non-null  object        \n",
      " 34  INCIDENT_CITY             9954 non-null   object        \n",
      " 35  INCIDENT_HOUR_OF_THE_DAY  10000 non-null  float64       \n",
      " 36  AGENT_ID                  10000 non-null  object        \n",
      " 37  VENDOR_ID                 6948 non-null   object        \n",
      " 38  AGENT_NAME                10000 non-null  object        \n",
      " 39  DATE_OF_JOINING           10000 non-null  object        \n",
      " 40  ADDRESS_LINE1_y           10000 non-null  object        \n",
      " 41  ADDRESS_LINE2_y           1451 non-null   object        \n",
      " 42  CITY_y                    9946 non-null   object        \n",
      " 43  STATE_y                   10000 non-null  object        \n",
      " 44  POSTAL_CODE_y             10000 non-null  float64       \n",
      " 45  EMP_ROUTING_NUMBER        10000 non-null  float64       \n",
      " 46  EMP_ACCT_NUMBER           10000 non-null  object        \n",
      " 47  VENDOR_NAME               6948 non-null   object        \n",
      " 48  ADDRESS_LINE1             6948 non-null   object        \n",
      " 49  ADDRESS_LINE2             1175 non-null   object        \n",
      " 50  CITY                      6903 non-null   object        \n",
      " 51  STATE                     6948 non-null   object        \n",
      " 52  POSTAL_CODE               6948 non-null   float64       \n",
      " 53  Colocation                10193 non-null  int64         \n",
      " 54  CLAIM_DEVIATION           10000 non-null  float64       \n",
      " 55  claim_Deviation_value     10193 non-null  object        \n",
      "dtypes: datetime64[ns](1), float64(14), int64(1), object(40)\n",
      "memory usage: 4.4+ MB\n"
     ]
    }
   ],
   "source": [
    "## 9-: ELIGIBLE_FOR_DISCOUNT\n",
    "doc2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "64676ad4-20ef-42c0-a82f-45a053c96232",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TENURE</th>\n",
       "      <th>EMPLOYMENT_STATUS</th>\n",
       "      <th>NO_OF_FAMILY_MEMBERS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>89.0</td>\n",
       "      <td>Y</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>81.0</td>\n",
       "      <td>Y</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>44.0</td>\n",
       "      <td>Y</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>111.0</td>\n",
       "      <td>Y</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>106.0</td>\n",
       "      <td>Y</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   TENURE EMPLOYMENT_STATUS  NO_OF_FAMILY_MEMBERS\n",
       "0    89.0                 Y                   3.0\n",
       "1    81.0                 Y                   3.0\n",
       "2    44.0                 Y                   6.0\n",
       "3   111.0                 Y                   3.0\n",
       "4   106.0                 Y                   6.0"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2[['TENURE','EMPLOYMENT_STATUS','NO_OF_FAMILY_MEMBERS']].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "fb4c8f98-7742-4186-a317-68d5d5aa3506",
   "metadata": {},
   "outputs": [],
   "source": [
    "def business_disc(doc2):\n",
    "    if((doc2['TENURE']>60) & (doc2['EMPLOYMENT_STATUS']=='N') &(doc2['NO_OF_FAMILY_MEMBERS']>=4)):\n",
    "        val = 1\n",
    "    else:\n",
    "        val = 0\n",
    "    return val\n",
    "\n",
    "doc2['ELIGIBLE_FOR_DISCOUNT'] = doc2.apply(business_disc, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "5152b620-8637-44e0-a8ad-72255955b0dd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.0293338565682331"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2['ELIGIBLE_FOR_DISCOUNT'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "127b374d-8b39-4bff-a83f-e22f07002f8d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    0\n",
       "1    0\n",
       "2    0\n",
       "3    0\n",
       "4    0\n",
       "Name: ELIGIBLE_FOR_DISCOUNT, dtype: int64"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## mean “ELIGIBLE_FOR_DISCOUNT” is -: 0.0293338565682331\n",
    "\n",
    "doc2.ELIGIBLE_FOR_DISCOUNT.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "edaa626a-792a-4ac7-8756-242e7ef6c1ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Timestamp('2021-06-30 00:00:00')"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## 10-: Claim Velocity\n",
    "\n",
    "doc2['TXN_DATE_TIME'].max()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "6454c52d-af61-4603-90dd-915d827e9848",
   "metadata": {},
   "outputs": [],
   "source": [
    "Num_of_claim_in_last_30_days = doc2.loc[(doc2['TXN_DATE_TIME'] > '2021-05-31') & (doc2['TXN_DATE_TIME'] < '2021-06-30')]\n",
    "Num_of_claim_in_last_03_days = doc2.loc[(doc2['TXN_DATE_TIME'] > '2021-06-27') & (doc2['TXN_DATE_TIME'] < '2021-06-30')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "f62b1053-e1bc-4b78-b879-13bf9a1441ca",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>CUSTOMER_NAME</th>\n",
       "      <th>...</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>Colocation</th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "      <th>claim_Deviation_value</th>\n",
       "      <th>ELIGIBLE_FOR_DISCOUNT</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Health</th>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>...</td>\n",
       "      <td>91</td>\n",
       "      <td>91</td>\n",
       "      <td>15</td>\n",
       "      <td>88</td>\n",
       "      <td>91</td>\n",
       "      <td>91</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "      <td>131</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Life</th>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>...</td>\n",
       "      <td>97</td>\n",
       "      <td>97</td>\n",
       "      <td>15</td>\n",
       "      <td>97</td>\n",
       "      <td>97</td>\n",
       "      <td>97</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "      <td>137</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mobile</th>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>...</td>\n",
       "      <td>87</td>\n",
       "      <td>87</td>\n",
       "      <td>12</td>\n",
       "      <td>86</td>\n",
       "      <td>87</td>\n",
       "      <td>87</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "      <td>129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Motor</th>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>...</td>\n",
       "      <td>82</td>\n",
       "      <td>82</td>\n",
       "      <td>18</td>\n",
       "      <td>82</td>\n",
       "      <td>82</td>\n",
       "      <td>82</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "      <td>119</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Property</th>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>...</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>11</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>83</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "      <td>122</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Travel</th>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>...</td>\n",
       "      <td>84</td>\n",
       "      <td>84</td>\n",
       "      <td>13</td>\n",
       "      <td>82</td>\n",
       "      <td>84</td>\n",
       "      <td>84</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "      <td>121</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                TXN_DATE_TIME  TRANSACTION_ID  CUSTOMER_ID  POLICY_NUMBER  \\\n",
       "INSURANCE_TYPE                                                              \n",
       "Health                    131             131          131            131   \n",
       "Life                      137             137          137            137   \n",
       "Mobile                    129             129          129            129   \n",
       "Motor                     119             119          119            119   \n",
       "Property                  122             122          122            122   \n",
       "Travel                    121             121          121            121   \n",
       "\n",
       "                POLICY_EFF_DT  LOSS_DT  REPORT_DT  PREMIUM_AMOUNT  \\\n",
       "INSURANCE_TYPE                                                      \n",
       "Health                    131      131        131             131   \n",
       "Life                      137      137        137             137   \n",
       "Mobile                    129      129        129             129   \n",
       "Motor                     119      119        119             119   \n",
       "Property                  122      122        122             122   \n",
       "Travel                    121      121        121             121   \n",
       "\n",
       "                CLAIM_AMOUNT  CUSTOMER_NAME  ...  VENDOR_NAME  ADDRESS_LINE1  \\\n",
       "INSURANCE_TYPE                               ...                               \n",
       "Health                   131            131  ...           91             91   \n",
       "Life                     137            137  ...           97             97   \n",
       "Mobile                   129            129  ...           87             87   \n",
       "Motor                    119            119  ...           82             82   \n",
       "Property                 122            122  ...           83             83   \n",
       "Travel                   121            121  ...           84             84   \n",
       "\n",
       "                ADDRESS_LINE2  CITY  STATE  POSTAL_CODE  Colocation  \\\n",
       "INSURANCE_TYPE                                                        \n",
       "Health                     15    88     91           91         131   \n",
       "Life                       15    97     97           97         137   \n",
       "Mobile                     12    86     87           87         129   \n",
       "Motor                      18    82     82           82         119   \n",
       "Property                   11    83     83           83         122   \n",
       "Travel                     13    82     84           84         121   \n",
       "\n",
       "                CLAIM_DEVIATION  claim_Deviation_value  ELIGIBLE_FOR_DISCOUNT  \n",
       "INSURANCE_TYPE                                                                 \n",
       "Health                      131                    131                    131  \n",
       "Life                        137                    137                    137  \n",
       "Mobile                      129                    129                    129  \n",
       "Motor                       119                    119                    119  \n",
       "Property                    122                    122                    122  \n",
       "Travel                      121                    121                    121  \n",
       "\n",
       "[6 rows x 56 columns]"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Num_of_claim_in_last_30_days.groupby('INSURANCE_TYPE').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "18290cbf-e6a8-4236-a023-caef83d89666",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>CUSTOMER_NAME</th>\n",
       "      <th>...</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>Colocation</th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "      <th>claim_Deviation_value</th>\n",
       "      <th>ELIGIBLE_FOR_DISCOUNT</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Health</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>0</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Life</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mobile</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Motor</th>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>...</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Property</th>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Travel</th>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>...</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                TXN_DATE_TIME  TRANSACTION_ID  CUSTOMER_ID  POLICY_NUMBER  \\\n",
       "INSURANCE_TYPE                                                              \n",
       "Health                      9               9            9              9   \n",
       "Life                        9               9            9              9   \n",
       "Mobile                      2               2            2              2   \n",
       "Motor                      10              10           10             10   \n",
       "Property                    9               9            9              9   \n",
       "Travel                     12              12           12             12   \n",
       "\n",
       "                POLICY_EFF_DT  LOSS_DT  REPORT_DT  PREMIUM_AMOUNT  \\\n",
       "INSURANCE_TYPE                                                      \n",
       "Health                      9        9          9               9   \n",
       "Life                        9        9          9               9   \n",
       "Mobile                      2        2          2               2   \n",
       "Motor                      10       10         10              10   \n",
       "Property                    9        9          9               9   \n",
       "Travel                     12       12         12              12   \n",
       "\n",
       "                CLAIM_AMOUNT  CUSTOMER_NAME  ...  VENDOR_NAME  ADDRESS_LINE1  \\\n",
       "INSURANCE_TYPE                               ...                               \n",
       "Health                     9              9  ...            7              7   \n",
       "Life                       9              9  ...            7              7   \n",
       "Mobile                     2              2  ...            1              1   \n",
       "Motor                     10             10  ...            7              7   \n",
       "Property                   9              9  ...            3              3   \n",
       "Travel                    12             12  ...            8              8   \n",
       "\n",
       "                ADDRESS_LINE2  CITY  STATE  POSTAL_CODE  Colocation  \\\n",
       "INSURANCE_TYPE                                                        \n",
       "Health                      0     7      7            7           9   \n",
       "Life                        1     7      7            7           9   \n",
       "Mobile                      0     1      1            1           2   \n",
       "Motor                       2     7      7            7          10   \n",
       "Property                    0     3      3            3           9   \n",
       "Travel                      2     8      8            8          12   \n",
       "\n",
       "                CLAIM_DEVIATION  claim_Deviation_value  ELIGIBLE_FOR_DISCOUNT  \n",
       "INSURANCE_TYPE                                                                 \n",
       "Health                        9                      9                      9  \n",
       "Life                          9                      9                      9  \n",
       "Mobile                        2                      2                      2  \n",
       "Motor                        10                     10                     10  \n",
       "Property                      9                      9                      9  \n",
       "Travel                       12                     12                     12  \n",
       "\n",
       "[6 rows x 56 columns]"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "Num_of_claim_in_last_03_days.groupby('INSURANCE_TYPE').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "832cb335-3ddc-4b28-b096-ed2e42578843",
   "metadata": {},
   "outputs": [],
   "source": [
    "claims = pd.DataFrame()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "142a872f-6edb-451b-919f-852c5c45489e",
   "metadata": {},
   "outputs": [],
   "source": [
    "claims= {\n",
    "          \"INSURANCE_TYPE\":[\"Health\",\"Life\",\"Mobile\",\"Motor\",\"Property\",\"Travel\"],\n",
    "          \"Num_of_claim_in_last_30_days\":[131,137,129,119,122,121],\n",
    "          \"Num_of_claim_in_last_03_days\":[9,9,2,10,9,12]\n",
    "}\n",
    "claims = pd.DataFrame(claims)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "f30e9d1c-8ab9-40e8-8781-442562b315da",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>Num_of_claim_in_last_30_days</th>\n",
       "      <th>Num_of_claim_in_last_03_days</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Health</td>\n",
       "      <td>131</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Life</td>\n",
       "      <td>137</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mobile</td>\n",
       "      <td>129</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Motor</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Property</td>\n",
       "      <td>122</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  INSURANCE_TYPE  Num_of_claim_in_last_30_days  Num_of_claim_in_last_03_days\n",
       "0         Health                           131                             9\n",
       "1           Life                           137                             9\n",
       "2         Mobile                           129                             2\n",
       "3          Motor                           119                            10\n",
       "4       Property                           122                             9"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "claims.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "9c6f492a-cfb9-4db3-89e0-c7df905a0cbe",
   "metadata": {},
   "outputs": [],
   "source": [
    "claims[\"CLAIM_VELOCITY\"] = claims['Num_of_claim_in_last_30_days']/claims['Num_of_claim_in_last_03_days']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "9eb42763-8478-4209-87fd-49f7c3f5e3df",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th>Num_of_claim_in_last_30_days</th>\n",
       "      <th>Num_of_claim_in_last_03_days</th>\n",
       "      <th>CLAIM_VELOCITY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Health</td>\n",
       "      <td>131</td>\n",
       "      <td>9</td>\n",
       "      <td>14.555556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Life</td>\n",
       "      <td>137</td>\n",
       "      <td>9</td>\n",
       "      <td>15.222222</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Mobile</td>\n",
       "      <td>129</td>\n",
       "      <td>2</td>\n",
       "      <td>64.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Motor</td>\n",
       "      <td>119</td>\n",
       "      <td>10</td>\n",
       "      <td>11.900000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Property</td>\n",
       "      <td>122</td>\n",
       "      <td>9</td>\n",
       "      <td>13.555556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Travel</td>\n",
       "      <td>121</td>\n",
       "      <td>12</td>\n",
       "      <td>10.083333</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  INSURANCE_TYPE  Num_of_claim_in_last_30_days  Num_of_claim_in_last_03_days  \\\n",
       "0         Health                           131                             9   \n",
       "1           Life                           137                             9   \n",
       "2         Mobile                           129                             2   \n",
       "3          Motor                           119                            10   \n",
       "4       Property                           122                             9   \n",
       "5         Travel                           121                            12   \n",
       "\n",
       "   CLAIM_VELOCITY  \n",
       "0       14.555556  \n",
       "1       15.222222  \n",
       "2       64.500000  \n",
       "3       11.900000  \n",
       "4       13.555556  \n",
       "5       10.083333  "
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "claims\n",
    "\n",
    "##claim Velocity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "1a2d7415-179b-40b7-b9de-8848eb64642a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>TXN_DATE_TIME</th>\n",
       "      <th>TRANSACTION_ID</th>\n",
       "      <th>CUSTOMER_ID</th>\n",
       "      <th>POLICY_NUMBER</th>\n",
       "      <th>POLICY_EFF_DT</th>\n",
       "      <th>LOSS_DT</th>\n",
       "      <th>REPORT_DT</th>\n",
       "      <th>PREMIUM_AMOUNT</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>CUSTOMER_NAME</th>\n",
       "      <th>...</th>\n",
       "      <th>VENDOR_NAME</th>\n",
       "      <th>ADDRESS_LINE1</th>\n",
       "      <th>ADDRESS_LINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTAL_CODE</th>\n",
       "      <th>Colocation</th>\n",
       "      <th>CLAIM_DEVIATION</th>\n",
       "      <th>claim_Deviation_value</th>\n",
       "      <th>ELIGIBLE_FOR_DISCOUNT</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>INSURANCE_TYPE</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Health</th>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>...</td>\n",
       "      <td>1123</td>\n",
       "      <td>1123</td>\n",
       "      <td>184</td>\n",
       "      <td>1115</td>\n",
       "      <td>1123</td>\n",
       "      <td>1123</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Life</th>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>...</td>\n",
       "      <td>1133</td>\n",
       "      <td>1133</td>\n",
       "      <td>179</td>\n",
       "      <td>1125</td>\n",
       "      <td>1133</td>\n",
       "      <td>1133</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "      <td>1671</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mobile</th>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>...</td>\n",
       "      <td>1139</td>\n",
       "      <td>1139</td>\n",
       "      <td>199</td>\n",
       "      <td>1135</td>\n",
       "      <td>1139</td>\n",
       "      <td>1139</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "      <td>1684</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Motor</th>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>...</td>\n",
       "      <td>1079</td>\n",
       "      <td>1079</td>\n",
       "      <td>180</td>\n",
       "      <td>1073</td>\n",
       "      <td>1079</td>\n",
       "      <td>1079</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "      <td>1564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Property</th>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>...</td>\n",
       "      <td>1106</td>\n",
       "      <td>1106</td>\n",
       "      <td>202</td>\n",
       "      <td>1097</td>\n",
       "      <td>1106</td>\n",
       "      <td>1106</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "      <td>1680</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Travel</th>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>...</td>\n",
       "      <td>1133</td>\n",
       "      <td>1133</td>\n",
       "      <td>192</td>\n",
       "      <td>1126</td>\n",
       "      <td>1133</td>\n",
       "      <td>1133</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "      <td>1665</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6 rows × 56 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                TXN_DATE_TIME  TRANSACTION_ID  CUSTOMER_ID  POLICY_NUMBER  \\\n",
       "INSURANCE_TYPE                                                              \n",
       "Health                   1680            1680         1680           1680   \n",
       "Life                     1671            1671         1671           1671   \n",
       "Mobile                   1684            1684         1684           1684   \n",
       "Motor                    1564            1564         1564           1564   \n",
       "Property                 1680            1680         1680           1680   \n",
       "Travel                   1665            1665         1665           1665   \n",
       "\n",
       "                POLICY_EFF_DT  LOSS_DT  REPORT_DT  PREMIUM_AMOUNT  \\\n",
       "INSURANCE_TYPE                                                      \n",
       "Health                   1680     1680       1680            1680   \n",
       "Life                     1671     1671       1671            1671   \n",
       "Mobile                   1684     1684       1684            1684   \n",
       "Motor                    1564     1564       1564            1564   \n",
       "Property                 1680     1680       1680            1680   \n",
       "Travel                   1665     1665       1665            1665   \n",
       "\n",
       "                CLAIM_AMOUNT  CUSTOMER_NAME  ...  VENDOR_NAME  ADDRESS_LINE1  \\\n",
       "INSURANCE_TYPE                               ...                               \n",
       "Health                  1680           1680  ...         1123           1123   \n",
       "Life                    1671           1671  ...         1133           1133   \n",
       "Mobile                  1684           1684  ...         1139           1139   \n",
       "Motor                   1564           1564  ...         1079           1079   \n",
       "Property                1680           1680  ...         1106           1106   \n",
       "Travel                  1665           1665  ...         1133           1133   \n",
       "\n",
       "                ADDRESS_LINE2  CITY  STATE  POSTAL_CODE  Colocation  \\\n",
       "INSURANCE_TYPE                                                        \n",
       "Health                    184  1115   1123         1123        1680   \n",
       "Life                      179  1125   1133         1133        1671   \n",
       "Mobile                    199  1135   1139         1139        1684   \n",
       "Motor                     180  1073   1079         1079        1564   \n",
       "Property                  202  1097   1106         1106        1680   \n",
       "Travel                    192  1126   1133         1133        1665   \n",
       "\n",
       "                CLAIM_DEVIATION  claim_Deviation_value  ELIGIBLE_FOR_DISCOUNT  \n",
       "INSURANCE_TYPE                                                                 \n",
       "Health                     1680                   1680                   1680  \n",
       "Life                       1671                   1671                   1671  \n",
       "Mobile                     1684                   1684                   1684  \n",
       "Motor                      1564                   1564                   1564  \n",
       "Property                   1680                   1680                   1680  \n",
       "Travel                     1665                   1665                   1665  \n",
       "\n",
       "[6 rows x 56 columns]"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##total Number of claims=\n",
    "doc2['TXN_DATE_TIME'].max()\n",
    "doc2['TXN_DATE_TIME'].min()\n",
    "total_Number_of_claim = Num_of_claim_in_last_30_days = doc2.loc[(doc2['TXN_DATE_TIME'] > '2020-06-01') & (doc2['TXN_DATE_TIME'] < '2021-06-30')]\n",
    "total_Number_of_claim.groupby('INSURANCE_TYPE').count()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "a46e1cff-3c08-456e-8ff7-041c75190c86",
   "metadata": {},
   "outputs": [],
   "source": [
    "## 11 -: Low Performing Agents \n",
    "\n",
    "\n",
    "doc2_subset = doc2.filter(['AGENT_ID','INSURANCE_TYPE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "id": "8e95c19a-f525-4fcc-8b5c-9e2e86796f73",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AGENT_ID    INSURANCE_TYPE\n",
       "AGENT00001  Mobile            3\n",
       "            Motor             4\n",
       "            Property          2\n",
       "            Travel            1\n",
       "AGENT00002  Life              1\n",
       "            Travel            2\n",
       "AGENT00003  Health            1\n",
       "            Life              4\n",
       "            Mobile            1\n",
       "            Motor             1\n",
       "            Property          1\n",
       "            Travel            3\n",
       "AGENT00004  Health            2\n",
       "            Life              4\n",
       "            Mobile            1\n",
       "            Motor             1\n",
       "            Property          1\n",
       "            Travel            3\n",
       "AGENT00005  Health            1\n",
       "            Motor             1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 179,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2_subset.value_counts(sort = False).head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "0f3b2c5f-18a2-4300-851e-57341160694a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AGENT00252     1\n",
       "AGENT01161     1\n",
       "AGENT00156     2\n",
       "AGENT00621     2\n",
       "AGENT00628     2\n",
       "              ..\n",
       "AGENT00723    16\n",
       "AGENT00849    17\n",
       "AGENT00388    17\n",
       "AGENT00319    18\n",
       "AGENT00992    19\n",
       "Name: AGENT_ID, Length: 1200, dtype: int64"
      ]
     },
     "execution_count": 180,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "doc2_subset.AGENT_ID.value_counts(ascending = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "6a41fd16-10c6-4102-aef9-54ae3a123fe5",
   "metadata": {},
   "outputs": [],
   "source": [
    "low_performance = doc2_subset.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "id": "3211dee7-296e-42e5-8bb1-fde80e33b2b4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AGENT_ID    INSURANCE_TYPE\n",
       "AGENT00731  Motor             7\n",
       "AGENT00238  Travel            6\n",
       "AGENT00769  Property          6\n",
       "AGENT00238  Mobile            6\n",
       "AGENT00807  Life              6\n",
       "                             ..\n",
       "AGENT00741  Life              1\n",
       "            Mobile            1\n",
       "            Travel            1\n",
       "AGENT00742  Mobile            1\n",
       "AGENT00839  Life              1\n",
       "Length: 5464, dtype: int64"
      ]
     },
     "execution_count": 182,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "low_performance"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "id": "8fb7e4ca-3d40-4a58-8242-f2b09f3774fb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5th percentile of low_performace :  1.0\n"
     ]
    }
   ],
   "source": [
    "print(\"5th percentile of low_performace : \",\n",
    "       np.percentile(low_performance, 5))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a995fa9d-bf84-4a20-9ca8-fbf0e8e1213c",
   "metadata": {},
   "outputs": [],
   "source": [
    "## All low performing agents are -: AGENT00252     1\n",
    "##                                  AGENT01161"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "id": "1a7c972a-dcfa-4414-8a1c-66860219ec9a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 10193 entries, 0 to 10192\n",
      "Data columns (total 57 columns):\n",
      " #   Column                    Non-Null Count  Dtype         \n",
      "---  ------                    --------------  -----         \n",
      " 0   TXN_DATE_TIME             10000 non-null  datetime64[ns]\n",
      " 1   TRANSACTION_ID            10000 non-null  object        \n",
      " 2   CUSTOMER_ID               10000 non-null  object        \n",
      " 3   POLICY_NUMBER             10000 non-null  object        \n",
      " 4   POLICY_EFF_DT             10000 non-null  object        \n",
      " 5   LOSS_DT                   10000 non-null  object        \n",
      " 6   REPORT_DT                 10000 non-null  object        \n",
      " 7   INSURANCE_TYPE            10000 non-null  object        \n",
      " 8   PREMIUM_AMOUNT            10000 non-null  float64       \n",
      " 9   CLAIM_AMOUNT              10000 non-null  float64       \n",
      " 10  CUSTOMER_NAME             10000 non-null  object        \n",
      " 11  ADDRESS_LINE1_x           10000 non-null  object        \n",
      " 12  ADDRESS_LINE2_x           1495 non-null   object        \n",
      " 13  CITY_x                    9946 non-null   object        \n",
      " 14  STATE_x                   10000 non-null  object        \n",
      " 15  POSTAL_CODE_x             10000 non-null  float64       \n",
      " 16  SSN                       10000 non-null  object        \n",
      " 17  MARITAL_STATUS            10000 non-null  object        \n",
      " 18  AGE                       10000 non-null  float64       \n",
      " 19  TENURE                    10000 non-null  float64       \n",
      " 20  EMPLOYMENT_STATUS         10000 non-null  object        \n",
      " 21  NO_OF_FAMILY_MEMBERS      10000 non-null  float64       \n",
      " 22  RISK_SEGMENTATION         10000 non-null  object        \n",
      " 23  HOUSE_TYPE                10000 non-null  object        \n",
      " 24  SOCIAL_CLASS              10000 non-null  object        \n",
      " 25  ROUTING_NUMBER            10000 non-null  float64       \n",
      " 26  ACCT_NUMBER               10000 non-null  object        \n",
      " 27  CUSTOMER_EDUCATION_LEVEL  9471 non-null   object        \n",
      " 28  CLAIM_STATUS              10000 non-null  object        \n",
      " 29  INCIDENT_SEVERITY         10000 non-null  object        \n",
      " 30  AUTHORITY_CONTACTED       10000 non-null  object        \n",
      " 31  ANY_INJURY                10000 non-null  float64       \n",
      " 32  POLICE_REPORT_AVAILABLE   10000 non-null  float64       \n",
      " 33  INCIDENT_STATE            10000 non-null  object        \n",
      " 34  INCIDENT_CITY             9954 non-null   object        \n",
      " 35  INCIDENT_HOUR_OF_THE_DAY  10000 non-null  float64       \n",
      " 36  AGENT_ID                  10000 non-null  object        \n",
      " 37  VENDOR_ID                 6948 non-null   object        \n",
      " 38  AGENT_NAME                10000 non-null  object        \n",
      " 39  DATE_OF_JOINING           10000 non-null  object        \n",
      " 40  ADDRESS_LINE1_y           10000 non-null  object        \n",
      " 41  ADDRESS_LINE2_y           1451 non-null   object        \n",
      " 42  CITY_y                    9946 non-null   object        \n",
      " 43  STATE_y                   10000 non-null  object        \n",
      " 44  POSTAL_CODE_y             10000 non-null  float64       \n",
      " 45  EMP_ROUTING_NUMBER        10000 non-null  float64       \n",
      " 46  EMP_ACCT_NUMBER           10000 non-null  object        \n",
      " 47  VENDOR_NAME               6948 non-null   object        \n",
      " 48  ADDRESS_LINE1             6948 non-null   object        \n",
      " 49  ADDRESS_LINE2             1175 non-null   object        \n",
      " 50  CITY                      6903 non-null   object        \n",
      " 51  STATE                     6948 non-null   object        \n",
      " 52  POSTAL_CODE               6948 non-null   float64       \n",
      " 53  Colocation                10193 non-null  int64         \n",
      " 54  CLAIM_DEVIATION           10000 non-null  float64       \n",
      " 55  claim_Deviation_value     10193 non-null  object        \n",
      " 56  ELIGIBLE_FOR_DISCOUNT     10193 non-null  int64         \n",
      "dtypes: datetime64[ns](1), float64(14), int64(2), object(40)\n",
      "memory usage: 4.5+ MB\n"
     ]
    }
   ],
   "source": [
    "doc2.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "2b9e2546-8fdf-4cdb-973c-acceb1b59cc4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>CLAIM_STATUS</th>\n",
       "      <th>RISK_SEGMENTATION</th>\n",
       "      <th>INCIDENT_SEVERITY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>A</td>\n",
       "      <td>L</td>\n",
       "      <td>Major Loss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>A</td>\n",
       "      <td>L</td>\n",
       "      <td>Major Loss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>Total Loss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>A</td>\n",
       "      <td>M</td>\n",
       "      <td>Total Loss</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>A</td>\n",
       "      <td>L</td>\n",
       "      <td>Major Loss</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  CLAIM_STATUS RISK_SEGMENTATION INCIDENT_SEVERITY\n",
       "0            A                 L        Major Loss\n",
       "1            A                 L        Major Loss\n",
       "2            A                 M        Total Loss\n",
       "3            A                 M        Total Loss\n",
       "4            A                 L        Major Loss"
      ]
     },
     "execution_count": 185,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#12 -: Suspicious Agents\n",
    "\n",
    "\n",
    "doc2[['CLAIM_STATUS','RISK_SEGMENTATION','INCIDENT_SEVERITY']].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "id": "c32aeed8-0ade-410d-ab9f-c81f13dec26b",
   "metadata": {},
   "outputs": [],
   "source": [
    "suspicion = doc2[(doc2['CLAIM_STATUS']=='A') & (doc2['RISK_SEGMENTATION']=='H') & (doc2['INCIDENT_SEVERITY']=='Major Loss')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "id": "a5f455ce-80a9-4a1f-9cac-c5b15fc57c36",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/ky/hyzr38s93hn5995txvx_6d8r0000gn/T/ipykernel_46914/1524102281.py:7: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  suspicious['SUSPICIOUS_Agent'] = suspicious.apply(suspicious_agent, axis= 1)\n"
     ]
    }
   ],
   "source": [
    "def suspicious_agent(suspicious):\n",
    "    if(suspicious['CLAIM_AMOUNT']>=15000):\n",
    "        val=1\n",
    "    else:\n",
    "        val=0\n",
    "    return val\n",
    "suspicious['SUSPICIOUS_Agent'] = suspicious.apply(suspicious_agent, axis= 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 217,
   "id": "6e87c470-a5c5-4d17-b23f-42506d84f3cb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>AGENT_ID</th>\n",
       "      <th>AGENT_NAME</th>\n",
       "      <th>CLAIM_AMOUNT</th>\n",
       "      <th>SUSPICIOUS</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>AGENT00152</td>\n",
       "      <td>John Hensel</td>\n",
       "      <td>54000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>AGENT00682</td>\n",
       "      <td>Michael Ortiz</td>\n",
       "      <td>18000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>AGENT00302</td>\n",
       "      <td>Brenda Trent</td>\n",
       "      <td>15000.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>106</th>\n",
       "      <td>AGENT00070</td>\n",
       "      <td>Sylvia Buckley</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>150</th>\n",
       "      <td>AGENT00132</td>\n",
       "      <td>Peggy Williams</td>\n",
       "      <td>12000.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       AGENT_ID      AGENT_NAME  CLAIM_AMOUNT  SUSPICIOUS\n",
       "42   AGENT00152     John Hensel       54000.0           1\n",
       "46   AGENT00682   Michael Ortiz       18000.0           1\n",
       "97   AGENT00302    Brenda Trent       15000.0           1\n",
       "106  AGENT00070  Sylvia Buckley        3000.0           0\n",
       "150  AGENT00132  Peggy Williams       12000.0           0"
      ]
     },
     "execution_count": 217,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "suspicious[['AGENT_ID', 'AGENT_NAME', 'CLAIM_AMOUNT', 'SUSPICIOUS']].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 218,
   "id": "b8ad86e2-b0b8-4c2f-ab4f-210aaf541dfd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.3462414578587699"
      ]
     },
     "execution_count": 218,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "suspicious['SUSPICIOUS'].mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "cf4cfaa0-f3a4-4ac5-b385-9cee2cacc471",
   "metadata": {},
   "outputs": [],
   "source": [
    "## mean of SUSPICIOUS_Agent column is -: 0.3462414578587699"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
